
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Beta series regression &#8212; My sample book</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">My sample book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="NBS.html">
   NBS
   <a id="network-based-statistic">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BCT.html">
   BCT graph metrics
   <a id="bct-graph-metrics">
   </a>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Statistics.html">
   Statistical Analysis
   <a id="stats">
   </a>
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/nibetaseries.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnibetaseries.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/nibetaseries.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Beta series regression
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#to-do-a-id-to-do-a">
     To Do
     <a id="to-do">
     </a>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fmriprep-a-id-fmriprep-a">
   fMRIprep
   <a id="fmriprep">
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nibetaseries-a-id-nibetaseries-a">
   Nibetaseries
   <a id="nibetaseries">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#checking-which-subjects-still-need-nibs">
     Checking which subjects still need nibs
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlation-results">
     Correlation results
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#edit-remaining-events-files">
       Edit remaining events files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#concatenate-runs-1-2-and-3-of-memmatch-task-in-4th-dimension-for-each-subject">
       Concatenate runs 1, 2, and 3 of MemMatch task in 4th dimension for each subject
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#age-group-differences-in-dmn-fpn-fc-during-cue-a-id-age-group-dif-mean-fc-a">
     Age group differences in DMN-FPN FC during cue
     <a id="age-group-dif-mean-fc">
     </a>
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="beta-series-regression">
<h1>Beta series regression<a class="headerlink" href="#beta-series-regression" title="Permalink to this headline">¶</a></h1>
<ol class="simple">
<li><p><a class="reference external" href="#to-do">To Do</a> <br></p></li>
<li><p><a class="reference external" href="#fmriprep">fMRIprep</a> <br></p></li>
<li><p><a class="reference external" href="#nibetaseries">Nibetaseries</a> <br></p></li>
<li><p>Age Group Differences <br></p>
<ol class="simple">
<li><p><a class="reference external" href="#age-group-dif-mean-fc">Mean FC during cue condition</a> <br></p></li>
</ol>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>  <span class="c1"># load the beta maps in python</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>  <span class="c1"># plot nifti images</span>
<span class="kn">from</span> <span class="nn">bct</span> <span class="kn">import</span> <span class="n">nbs</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">savemat</span>
<span class="kn">from</span> <span class="nn">mne.viz</span> <span class="kn">import</span> <span class="n">plot_connectivity_circle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/nilearn/datasets/__init__.py:96: FutureWarning: Fetchers from the nilearn.datasets module will be updated in version 0.9 to return python strings instead of bytes and Pandas dataframes instead of Numpy arrays.
  &quot;Numpy arrays.&quot;, FutureWarning)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;/Volumes/psybrain/ADM/derivatives&#39;</span>
<span class="n">results_dir</span> <span class="o">=</span> <span class="s1">&#39;/Volumes/schnyer/Megan/adm_mem-fc/analysis/stats/&#39;</span>
<span class="n">nibs_dir</span><span class="o">=</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries&#39;</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MemMatch1&#39;</span><span class="p">,</span> <span class="s1">&#39;MemMatch2&#39;</span><span class="p">,</span> <span class="s1">&#39;MemMatch3&#39;</span><span class="p">]</span>
<span class="n">trial_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cue&#39;</span><span class="p">,</span> <span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="s1">&#39;mismatch&#39;</span><span class="p">]</span>

<span class="n">atlas_file</span><span class="o">=</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz&#39;</span>
<span class="n">atlas_lut</span><span class="o">=</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/power264_labels.tsv&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subjects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="s1">&#39;/nibs/subjects.txt&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="n">subjects</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;30004&#39;, &#39;30008&#39;, &#39;30009&#39;, &#39;30015&#39;, &#39;30019&#39;, &#39;30020&#39;, &#39;30023&#39;,
       &#39;30040&#39;, &#39;30057&#39;, &#39;30064&#39;, &#39;30066&#39;, &#39;30069&#39;, &#39;30074&#39;, &#39;30085&#39;,
       &#39;30088&#39;, &#39;30090&#39;, &#39;30091&#39;, &#39;30095&#39;, &#39;30096&#39;, &#39;30105&#39;, &#39;30116&#39;,
       &#39;30118&#39;, &#39;30119&#39;, &#39;30128&#39;, &#39;30181&#39;, &#39;30217&#39;, &#39;30227&#39;, &#39;30236&#39;,
       &#39;30242&#39;, &#39;30255&#39;, &#39;30274&#39;, &#39;30283&#39;, &#39;30295&#39;, &#39;30330&#39;, &#39;30346&#39;,
       &#39;30376&#39;, &#39;30395&#39;, &#39;30400&#39;, &#39;30403&#39;, &#39;30412&#39;, &#39;30426&#39;, &#39;30432&#39;,
       &#39;30466&#39;, &#39;30469&#39;, &#39;30476&#39;, &#39;30478&#39;, &#39;30568&#39;, &#39;30570&#39;, &#39;30581&#39;,
       &#39;30584&#39;, &#39;30588&#39;, &#39;40160&#39;, &#39;40170&#39;, &#39;40175&#39;, &#39;40288&#39;, &#39;40351&#39;,
       &#39;40490&#39;, &#39;40512&#39;, &#39;40519&#39;, &#39;40520&#39;, &#39;40524&#39;, &#39;40547&#39;, &#39;40564&#39;,
       &#39;40615&#39;, &#39;40619&#39;, &#39;40624&#39;, &#39;40638&#39;, &#39;40649&#39;, &#39;40650&#39;, &#39;40656&#39;,
       &#39;40658&#39;, &#39;40664&#39;, &#39;40665&#39;, &#39;40668&#39;, &#39;40672&#39;, &#39;40685&#39;, &#39;40694&#39;,
       &#39;40720&#39;, &#39;40738&#39;, &#39;40743&#39;, &#39;40750&#39;, &#39;40773&#39;, &#39;40778&#39;, &#39;40796&#39;,
       &#39;40803&#39;, &#39;40855&#39;, &#39;40861&#39;, &#39;40930&#39;, &#39;40961&#39;, &#39;40968&#39;], dtype=&#39;&lt;U5&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atlas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">atlas_lut</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="n">atlas</span><span class="o">.</span><span class="n">regions</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Uncertain&#39;, &#39;Sensory/somatomotor Hand&#39;,
       &#39;Sensory/somatomotor Mouth&#39;, &#39;Cingulo-opercular Task Control&#39;,
       &#39;Auditory&#39;, &#39;Default mode&#39;, &#39;Memory retrieval?&#39;,
       &#39;Ventral attention&#39;, &#39;Visual&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Salience&#39;, &#39;Subcortical&#39;, &#39;Cerebellar&#39;, &#39;Dorsal attention&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atlas</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;regions&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atlas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">atlas_lut</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="n">dmn</span> <span class="o">=</span> <span class="n">atlas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">atlas</span><span class="p">[</span><span class="s1">&#39;regions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Default&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">fpn</span> <span class="o">=</span> <span class="n">atlas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">atlas</span><span class="p">[</span><span class="s1">&#39;regions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Fronto-parietal&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">dmn_fpn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">dmn</span><span class="p">,</span> <span class="n">fpn</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>

<span class="n">power</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_coords_power_2011</span><span class="p">()</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">power</span><span class="o">.</span><span class="n">rois</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">power</span><span class="o">.</span><span class="n">rois</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">power</span><span class="o">.</span><span class="n">rois</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<section id="to-do-a-id-to-do-a">
<h2>To Do <a id='to-do'></a><a class="headerlink" href="#to-do-a-id-to-do-a" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Finish running fmriprep. Repeat for MemMatch 2, 3</p></li>
</ol>
<p>9/30: Participants currently running on TACC: <br />
40961 40968 30255 40861 40855 40782 40496 30417 30090</p>
<p>10/2: Participants complete:
40961(y) 40968(y) 30255(y) 40861(y) 40855(y) 40782(y) 40496(y) 30417(y) 30090(y)</p>
<p>still need fmriprep on
<strong>30417</strong> - no MemMatch (drop) <br />
<strong>40782</strong> - run 1: 	 nibs crashfile: /Volumes/psybrain/ADM/derivatives/nibs/sub-40782/log/crash-20211010-115537-PSYC-mcm5324-betaseries_node.a0-de5d651f-0cca-4483-9b22-4fe6ed206768.txt, only has 8 trials for some reason, not 12
<strong>40930</strong> \</p>
<ol class="simple">
<li><p>Run nibetaseries</p></li>
</ol>
<p>Confound selection: <br />
<a class="reference external" href="https://neurostars.org/t/confounds-from-fmriprep-which-one-would-you-use-for-glm/326">https://neurostars.org/t/confounds-from-fmriprep-which-one-would-you-use-for-glm/326</a> <br />
<a class="reference external" href="https://code.stanford.edu/rblair2/fmriprep-test/-/blob/master/docs/outputs.rst">https://code.stanford.edu/rblair2/fmriprep-test/-/blob/master/docs/outputs.rst</a> \</p>
<p><strong>Participants missing BIDS</strong>
40496 - MemMatch1 <br />
30433? <br />
30407 - anat only <br />
40876</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="fmriprep-a-id-fmriprep-a">
<h1>fMRIprep <a id='fmriprep'></a><a class="headerlink" href="#fmriprep-a-id-fmriprep-a" title="Permalink to this headline">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
Results included in this manuscript come from preprocessing
performed using *fMRIPrep* 1.3.2
(@fmriprep1; @fmriprep2; RRID:SCR_016216),
which is based on *Nipype* 1.1.9
(@nipype1; @nipype2; RRID:SCR_002502).

Anatomical data preprocessing

: The T1-weighted (T1w) image was corrected for intensity non-uniformity (INU)
with `N4BiasFieldCorrection` [@n4], distributed with ANTs 2.2.0 [@ants, RRID:SCR_004757], and used as T1w-reference throughout the workflow.
The T1w-reference was then skull-stripped with a *Nipype* implementation of
the `antsBrainExtraction.sh` workflow (from ANTs), using OASIS30ANTs
as target template.
Spatial normalization to the
*ICBM 152 Nonlinear Asymmetrical template version 2009c* [@mni152nlin2009casym, RRID:SCR_008796]
was performed through nonlinear registration with `antsRegistration`
(ANTs 2.2.0), using brain-extracted versions of both T1w volume
and template.
Brain tissue segmentation of cerebrospinal fluid (CSF),
white-matter (WM) and gray-matter (GM) was performed on
the brain-extracted T1w using `fast` [FSL 5.0.9, RRID:SCR_002823,
@fsl_fast].


Functional data preprocessing

: For each of the 1 BOLD runs found per subject (across all
tasks and sessions), the following preprocessing was performed.
First, a reference volume and its skull-stripped version were generated
using a custom methodology of *fMRIPrep*.
The BOLD reference was then co-registered to the T1w reference using
`flirt` [FSL 5.0.9, @flirt] with the boundary-based registration [@bbr]
cost-function.
Co-registration was configured with nine degrees of freedom to account
for distortions remaining in the BOLD reference.
Head-motion parameters with respect to the BOLD reference
(transformation matrices, and six corresponding rotation and translation
parameters) are estimated before any spatiotemporal filtering using
`mcflirt` [FSL 5.0.9, @mcflirt].
The BOLD time-series (including slice-timing correction when applied)
were resampled onto their original, native space by applying
a single, composite transform to correct for head-motion and
susceptibility distortions.
These resampled BOLD time-series will be referred to as *preprocessed
BOLD in original space*, or just *preprocessed BOLD*.
The BOLD time-series were resampled to MNI152NLin2009cAsym standard space,
generating a *preprocessed BOLD run in MNI152NLin2009cAsym space*.
First, a reference volume and its skull-stripped version were generated
using a custom methodology of *fMRIPrep*.
Several confounding time-series were calculated based on the
*preprocessed BOLD*: framewise displacement (FD), DVARS and
three region-wise global signals.
FD and DVARS are calculated for each functional run, both using their
implementations in *Nipype* [following the definitions by @power_fd_dvars].
The three global signals are extracted within the CSF, the WM, and
the whole-brain masks.
Additionally, a set of physiological regressors were extracted to
allow for component-based noise correction [*CompCor*, @compcor].
Principal components are estimated after high-pass filtering the
*preprocessed BOLD* time-series (using a discrete cosine filter with
128s cut-off) for the two *CompCor* variants: temporal (tCompCor)
and anatomical (aCompCor).
Six tCompCor components are then calculated from the top 5% variable
voxels within a mask covering the subcortical regions.
This subcortical mask is obtained by heavily eroding the brain mask,
which ensures it does not include cortical GM regions.
For aCompCor, six components are calculated within the intersection of
the aforementioned mask and the union of CSF and WM masks calculated
in T1w space, after their projection to the native space of each
functional run (using the inverse BOLD-to-T1w transformation).
The head-motion estimates calculated in the correction step were also
placed within the corresponding confounds file.
All resamplings can be performed with *a single interpolation
step* by composing all the pertinent transformations (i.e. head-motion
transform matrices, susceptibility distortion correction when available,
and co-registrations to anatomical and template spaces).
Gridded (volumetric) resamplings were performed using `antsApplyTransforms` (ANTs),
configured with Lanczos interpolation to minimize the smoothing
effects of other kernels [@lanczos].
Non-gridded (surface) resamplings were performed using `mri_vol2surf`
(FreeSurfer).


Many internal operations of *fMRIPrep* use
*Nilearn* 0.5.0 [@nilearn, RRID:SCR_001362],
mostly within the functional processing workflow.
For more details of the pipeline, see [the section corresponding
to workflows in *fMRIPrep*&#39;s documentation](https://fmriprep.readthedocs.io/en/latest/workflows.html &quot;FMRIPrep&#39;s documentation&quot;).

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">confounds</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;bad_tr&#39;</span><span class="p">,</span> <span class="s1">&#39;ones&#39;</span><span class="p">,</span> <span class="s1">&#39;zeros&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">c</span><span class="o">/</span><span class="n">c825cr816cg14jn4bs40my5h0000gr</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_24402</span><span class="o">/</span><span class="mf">2279636747.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">confounds</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;bad_tr&#39;</span><span class="p">,</span> <span class="s1">&#39;ones&#39;</span><span class="p">,</span> <span class="s1">&#39;zeros&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;confounds&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="highlight-for notranslate"><div class="highlight"><pre><span></span>    for task in tasks:
        confounds_file = data_dir + &#39;/fmriprep/sub-%s/func/sub-%s_task-%s_run-01_desc-confounds_regressors.tsv&#39; % (subject, subject, task)
        print(confounds_file)
        
        confounds = pd.read_csv(confounds_file, sep = &#39;\t&#39;)
        for colname in [&#39;bad_tr&#39;, &#39;ones&#39;, &#39;zeros&#39;, &#39;motion_outlier_01&#39;]:
            if colname in confounds.columns:
                confounds.drop(colname, axis=1, inplace=True)
        if not os.path.exists(confounds_file.split(&#39;.tsv&#39;)[0] + &#39;_original.tsv&#39;):
            confounds.to_csv(confounds_file.split(&#39;.tsv&#39;)[0] + &#39;_original.tsv&#39;, index=False, sep = &#39;\t&#39;)

        confounds[&#39;motion_outlier_00&#39;] = np.where(confounds[&#39;framewise_displacement&#39;] &gt;= 0.5, 1, 0)
#         confounds[&#39;motion_outlier_01&#39;] = np.ones(len(confounds[&#39;framewise_displacement&#39;]), dtype=int)
        confounds.to_csv(confounds_file, index=False, sep = &#39;\t&#39;)
        
        print(confounds.loc[confounds[&#39;motion_outlier_00&#39;] &gt; 0.5])
        
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/sub-40782/func/*events.tsv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">events_files</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;/Volumes/psybrain/ADM/sub-40782/func/sub-40782_task-MemMatch3_run-01_events.tsv&#39;, &#39;/Volumes/psybrain/ADM/sub-40782/func/sub-40782_task-MemRepeat3_run-01_events.tsv&#39;, &#39;/Volumes/psybrain/ADM/sub-40782/func/sub-40782_task-MemRepeat1_run-01_events.tsv&#39;, &#39;/Volumes/psybrain/ADM/sub-40782/func/sub-40782_task-MemMatch2_run-01_events.tsv&#39;, &#39;/Volumes/psybrain/ADM/sub-40782/func/sub-40782_task-MemMatch1_run-01_events.tsv&#39;, &#39;/Volumes/psybrain/ADM/sub-40782/func/sub-40782_task-MemRepeat2_run-01_events.tsv&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nibetaseries-a-id-nibetaseries-a">
<h1>Nibetaseries <a id='nibetaseries'></a><a class="headerlink" href="#nibetaseries-a-id-nibetaseries-a" title="Permalink to this headline">¶</a></h1>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /Volumes/psybrain/ADM/derivatives/nibs/
rm -rf nibetaseries_work/.smb*

<span class="k">for</span> subject <span class="k">in</span> <span class="sb">`</span>cat remaining.txt <span class="p">|</span> tail -10<span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
    <span class="nb">echo</span> <span class="nv">$subject</span>
    <span class="nb">printf</span> <span class="s1">&#39;\n\n RUN 1&#39;</span>
    nibs --nthreads <span class="m">1</span> -n-cpus <span class="m">1</span> -c a_comp_cor_00 trans_x trans_y trans_z rot_x rot_y rot_z motion_outlier_00 -t MemMatch1 --participant-label <span class="nv">$subject</span> --estimator lss --hrf-model <span class="s1">&#39;spm + derivative&#39;</span> -sm <span class="m">6</span> /Volumes/psybrain/ADM /Volumes/psybrain/ADM/derivatives/fmriprep /Volumes/psybrain/ADM/derivatives/nibs participant<span class="p">;</span> sleep <span class="m">10</span><span class="p">;</span>
    <span class="nb">printf</span> <span class="s1">&#39;\n\n RUN 2&#39;</span>
    nibs --nthreads <span class="m">1</span> -n-cpus <span class="m">1</span> -c a_comp_cor_00 trans_x trans_y trans_z rot_x rot_y rot_z motion_outlier_00 -t MemMatch2 --participant-label <span class="nv">$subject</span> --estimator lss --hrf-model <span class="s1">&#39;spm + derivative&#39;</span> -sm <span class="m">6</span> /Volumes/psybrain/ADM /Volumes/psybrain/ADM/derivatives/fmriprep /Volumes/psybrain/ADM/derivatives/nibs participant<span class="p">;</span> sleep <span class="m">10</span><span class="p">;</span>
    <span class="nb">printf</span> <span class="s1">&#39;\n\n RUN 3&#39;</span>
    nibs --nthreads <span class="m">1</span> -n-cpus <span class="m">1</span> -c a_comp_cor_00 trans_x trans_y trans_z rot_x rot_y rot_z motion_outlier_00 -t MemMatch3 --participant-label <span class="nv">$subject</span> --estimator lss --hrf-model <span class="s1">&#39;spm + derivative&#39;</span> -sm <span class="m">6</span> /Volumes/psybrain/ADM /Volumes/psybrain/ADM/derivatives/fmriprep /Volumes/psybrain/ADM/derivatives/nibs participant<span class="p">;</span> sleep <span class="m">10</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">&quot;completed subjects: &quot;</span> 
    <span class="nb">echo</span> <span class="sb">`</span>ls nibetaseries/. <span class="p">|</span> wc -l<span class="sb">`</span>
<span class="k">done</span>
</pre></div>
</div>
<section id="checking-which-subjects-still-need-nibs">
<h2>Checking which subjects still need nibs<a class="headerlink" href="#checking-which-subjects-still-need-nibs" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">remaining</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subjects</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;sub-&#39;</span> <span class="o">+</span> <span class="n">subject</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">nibs_dir</span><span class="p">):</span>
        <span class="n">remaining</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;subjects remaining %.f&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">remaining</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/subjects_remaining.txt&#39;</span><span class="p">,</span> <span class="n">remaining</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>subjects remaining 40
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subject</span> <span class="o">=</span> <span class="s1">&#39;30004&#39;</span>
<span class="n">check_file</span> <span class="o">=</span> <span class="n">nibs_dir</span> <span class="o">+</span> <span class="s1">&#39;/</span><span class="si">%s</span><span class="s1">/func/</span><span class="si">%s</span><span class="s1">_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">subject</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">check_file</span><span class="p">)</span>
<span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">check_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/30004/func/30004_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub_run1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sub_run2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sub_run3</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/subjects.txt&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
    <span class="n">check_file</span> <span class="o">=</span> <span class="n">nibs_dir</span> <span class="o">+</span> <span class="s1">&#39;/sub-</span><span class="si">%s</span><span class="s1">/func/sub-</span><span class="si">%s</span><span class="s1">_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">subject</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">check_file</span><span class="p">)</span>
    <span class="n">completed</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">check_file</span><span class="p">)</span>
    <span class="n">nrun</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">completed</span><span class="p">)</span>
    <span class="n">missing</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">if</span> <span class="n">nrun</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">completed</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;MemMatch&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">missing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;MemMatch&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">1</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">missing</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="s1">&#39;1&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">missing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;missing 1&#39;</span><span class="p">)</span>
            <span class="n">sub_run1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="s1">&#39;2&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">missing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;missing 2&#39;</span><span class="p">)</span>
            <span class="n">sub_run2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="s1">&#39;3&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">missing</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;missing 3&#39;</span><span class="p">)</span>
            <span class="n">sub_run3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30004
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30004/func/sub-30004_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30008
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30008/func/sub-30008_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30009
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30009/func/sub-30009_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30015
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30015/func/sub-30015_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30019
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30019/func/sub-30019_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30020
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30020/func/sub-30020_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30023
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30023/func/sub-30023_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30040
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30040/func/sub-30040_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30057
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30057/func/sub-30057_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30064
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30064/func/sub-30064_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30066
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30066/func/sub-30066_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30069
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30069/func/sub-30069_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30074
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30074/func/sub-30074_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30085
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30085/func/sub-30085_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30088
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30088/func/sub-30088_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30090
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30090/func/sub-30090_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30091
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30091/func/sub-30091_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30095
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30095/func/sub-30095_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30096
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30096/func/sub-30096_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30105
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30105/func/sub-30105_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30116
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30116/func/sub-30116_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30118
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30118/func/sub-30118_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30119
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30119/func/sub-30119_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30128
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30128/func/sub-30128_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30181
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30181/func/sub-30181_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30217
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30217/func/sub-30217_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30227
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30227/func/sub-30227_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30236
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30236/func/sub-30236_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30242
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30242/func/sub-30242_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30255
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30255/func/sub-30255_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30274
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30274/func/sub-30274_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30283
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30283/func/sub-30283_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30295
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30295/func/sub-30295_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30330
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30330/func/sub-30330_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30346
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30346/func/sub-30346_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30376
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30376/func/sub-30376_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30395
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30395/func/sub-30395_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30400
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30400/func/sub-30400_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30403
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30403/func/sub-30403_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30412
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30412/func/sub-30412_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30426
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30426/func/sub-30426_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30432
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30432/func/sub-30432_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30466
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30466/func/sub-30466_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30469
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30469/func/sub-30469_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30476
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30476/func/sub-30476_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30478
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30478/func/sub-30478_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30568
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30568/func/sub-30568_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30570
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30570/func/sub-30570_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30581
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30581/func/sub-30581_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30584
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30584/func/sub-30584_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
30588
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-30588/func/sub-30588_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40160
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40160/func/sub-40160_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40170
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40170/func/sub-40170_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40175
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40175/func/sub-40175_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40288
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40288/func/sub-40288_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40351
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40351/func/sub-40351_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40490
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40490/func/sub-40490_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40512
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40512/func/sub-40512_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40519
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40519/func/sub-40519_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40520
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40520/func/sub-40520_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40524
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40524/func/sub-40524_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40547
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40547/func/sub-40547_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40564
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40564/func/sub-40564_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40615
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40615/func/sub-40615_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40619
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40619/func/sub-40619_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40624
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40624/func/sub-40624_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40638
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40638/func/sub-40638_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40649
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40649/func/sub-40649_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40650
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40650/func/sub-40650_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40656
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40656/func/sub-40656_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40658
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40658/func/sub-40658_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40664
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40664/func/sub-40664_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40665
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40665/func/sub-40665_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40668
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40668/func/sub-40668_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40672
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40672/func/sub-40672_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40685
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40685/func/sub-40685_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40694
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40694/func/sub-40694_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40720
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40720/func/sub-40720_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40738
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40738/func/sub-40738_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40743
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40743/func/sub-40743_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40750
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40750/func/sub-40750_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40773
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40773/func/sub-40773_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40778
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40778/func/sub-40778_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40796
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40796/func/sub-40796_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40803
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40803/func/sub-40803_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40855
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40855/func/sub-40855_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40861
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40861/func/sub-40861_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40930
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40930/func/sub-40930_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
missing 1
missing 2
missing 3
40961
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40961/func/sub-40961_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
40968
/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40968/func/sub-40968_task-MemMatch[1-3]_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;remaining subjects without MemMatch1 beta images: n =%.f&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_run1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;remaining subjects without MemMatch2 beta images: n =%.f&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_run2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;remaining subjects without MemMatch3 beta images: n =%.f&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_run3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>remaining subjects without MemMatch1 beta images: n =1
remaining subjects without MemMatch2 beta images: n =1
remaining subjects without MemMatch3 beta images: n =1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/subjects_run1.txt&#39;</span><span class="p">,</span> <span class="n">sub_run1</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/subjects_run2.txt&#39;</span><span class="p">,</span> <span class="n">sub_run2</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/subjects_run3.txt&#39;</span><span class="p">,</span> <span class="n">sub_run3</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>```bash
cd /Volumes/psybrain/ADM/derivatives/nibs/
rm -rf nibetaseries_work/.smb*

# nibs -c a_comp_cor_00 trans_x trans_y trans_z rot_x rot_y rot_z motion_outlier_00 -t MemMatch1 --participant-label `cat subjects_run1.txt | head -8` --estimator lss --hrf-model &#39;spm + derivative&#39; -sm 6 /Volumes/psybrain/ADM /Volumes/psybrain/ADM/derivatives/fmriprep /Volumes/psybrain/ADM/derivatives/nibs participant
nibs -c a_comp_cor_00 trans_x trans_y trans_z rot_x rot_y rot_z motion_outlier_00 -t MemMatch1 --participant-label sub-40930 sub-40930 --estimator lss --hrf-model &#39;spm + derivative&#39; -sm 6 /Volumes/psybrain/ADM /Volumes/psybrain/ADM/derivatives/fmriprep /Volumes/psybrain/ADM/derivatives/nibs participant


```
</pre></div>
</div>
</div>
</div>
</section>
<section id="correlation-results">
<h2>Correlation results<a class="headerlink" href="#correlation-results" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/sub-30004/func/*MemMatch1*[0-9]_events.tsv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;/Volumes/psybrain/ADM/sub-30004/func/sub-30004_task-MemMatch1_run-01_events.tsv&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">out_dir</span> <span class="o">+</span> <span class="s2">&quot;/nibs/nibetaseries/sub-30004/func&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;sub-30004_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-mismatch_correlation.tsv&#39;,
 &#39;sub-30004_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-mismatch_correlation.svg&#39;,
 &#39;sub-30004_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz&#39;,
 &#39;sub-30004_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-match_correlation.svg&#39;,
 &#39;sub-30004_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-match_correlation.tsv&#39;,
 &#39;sub-30004_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz&#39;,
 &#39;sub-30004_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;sub-30004_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;sub-30004_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-match_correlation.tsv&#39;,
 &#39;sub-30004_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz&#39;,
 &#39;sub-30004_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-mismatch_correlation.tsv&#39;,
 &#39;sub-30004_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-cue_correlation.svg&#39;,
 &#39;sub-30004_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz&#39;,
 &#39;sub-30004_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz&#39;,
 &#39;sub-30004_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-cue_correlation.svg&#39;,
 &#39;sub-30004_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz&#39;,
 &#39;sub-30004_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-match_correlation.svg&#39;,
 &#39;sub-30004_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-match_correlation.svg&#39;,
 &#39;sub-30004_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-mismatch_correlation.svg&#39;,
 &#39;sub-30004_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-mismatch_correlation.tsv&#39;,
 &#39;sub-30004_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz&#39;,
 &#39;sub-30004_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;sub-30004_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz&#39;,
 &#39;sub-30004_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-mismatch_correlation.svg&#39;,
 &#39;sub-30004_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-match_correlation.tsv&#39;,
 &#39;sub-30004_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz&#39;,
 &#39;sub-30004_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-cue_correlation.svg&#39;]
</pre></div>
</div>
</div>
</div>
<section id="edit-remaining-events-files">
<h3>Edit remaining events files<a class="headerlink" href="#edit-remaining-events-files" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pd.read_csv(&#39;/Volumes/psybrain/ADM/sub-30008/func/sub-30008_task-MemMatch1_run-01_events.tsv&#39;, sep = &#39;\t&#39;)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/sub-40930/func/sub-40930_task-MemMatch1_run-01_events.tsv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>onset</th>
      <th>duration</th>
      <th>trial_type</th>
      <th>correct</th>
      <th>response_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>6.0</td>
      <td>cue</td>
      <td>Y</td>
      <td>12181</td>
    </tr>
    <tr>
      <th>1</th>
      <td>21.0</td>
      <td>6.0</td>
      <td>cue</td>
      <td>Y</td>
      <td>11331</td>
    </tr>
    <tr>
      <th>2</th>
      <td>39.0</td>
      <td>6.0</td>
      <td>cue</td>
      <td>Y</td>
      <td>11560</td>
    </tr>
    <tr>
      <th>3</th>
      <td>60.0</td>
      <td>6.0</td>
      <td>cue</td>
      <td>Y</td>
      <td>11624</td>
    </tr>
    <tr>
      <th>4</th>
      <td>81.0</td>
      <td>6.0</td>
      <td>cue</td>
      <td>Y</td>
      <td>13041</td>
    </tr>
    <tr>
      <th>5</th>
      <td>102.0</td>
      <td>6.0</td>
      <td>cue</td>
      <td>N</td>
      <td>11793</td>
    </tr>
    <tr>
      <th>6</th>
      <td>120.0</td>
      <td>6.0</td>
      <td>cue</td>
      <td>Y</td>
      <td>11412</td>
    </tr>
    <tr>
      <th>7</th>
      <td>139.5</td>
      <td>6.0</td>
      <td>cue</td>
      <td>N</td>
      <td>11719</td>
    </tr>
    <tr>
      <th>8</th>
      <td>159.0</td>
      <td>6.0</td>
      <td>cue</td>
      <td>N</td>
      <td>11394</td>
    </tr>
    <tr>
      <th>9</th>
      <td>178.5</td>
      <td>6.0</td>
      <td>cue</td>
      <td>Y</td>
      <td>12500</td>
    </tr>
    <tr>
      <th>10</th>
      <td>198.0</td>
      <td>6.0</td>
      <td>cue</td>
      <td>Y</td>
      <td>11200</td>
    </tr>
    <tr>
      <th>11</th>
      <td>219.0</td>
      <td>6.0</td>
      <td>cue</td>
      <td>Y</td>
      <td>11583</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12.0</td>
      <td>3.0</td>
      <td>mismatch</td>
      <td>Y</td>
      <td>12181</td>
    </tr>
    <tr>
      <th>13</th>
      <td>30.0</td>
      <td>3.0</td>
      <td>match</td>
      <td>Y</td>
      <td>11331</td>
    </tr>
    <tr>
      <th>14</th>
      <td>48.0</td>
      <td>3.0</td>
      <td>match</td>
      <td>Y</td>
      <td>11560</td>
    </tr>
    <tr>
      <th>15</th>
      <td>69.0</td>
      <td>3.0</td>
      <td>mismatch</td>
      <td>Y</td>
      <td>11624</td>
    </tr>
    <tr>
      <th>16</th>
      <td>90.0</td>
      <td>3.0</td>
      <td>mismatch</td>
      <td>Y</td>
      <td>13041</td>
    </tr>
    <tr>
      <th>17</th>
      <td>111.0</td>
      <td>3.0</td>
      <td>mismatch</td>
      <td>N</td>
      <td>11793</td>
    </tr>
    <tr>
      <th>18</th>
      <td>129.0</td>
      <td>3.0</td>
      <td>match</td>
      <td>Y</td>
      <td>11412</td>
    </tr>
    <tr>
      <th>19</th>
      <td>148.5</td>
      <td>3.0</td>
      <td>mismatch</td>
      <td>N</td>
      <td>11719</td>
    </tr>
    <tr>
      <th>20</th>
      <td>168.0</td>
      <td>3.0</td>
      <td>mismatch</td>
      <td>N</td>
      <td>11394</td>
    </tr>
    <tr>
      <th>21</th>
      <td>187.5</td>
      <td>3.0</td>
      <td>match</td>
      <td>Y</td>
      <td>12500</td>
    </tr>
    <tr>
      <th>22</th>
      <td>207.0</td>
      <td>3.0</td>
      <td>match</td>
      <td>Y</td>
      <td>11200</td>
    </tr>
    <tr>
      <th>23</th>
      <td>228.0</td>
      <td>3.0</td>
      <td>match</td>
      <td>Y</td>
      <td>11583</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/sub-40782/func/sub-40782_task-MemMatch3_run-01_events.tsv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># eventsnew = events.copy()</span>
<span class="c1"># eventsnew[&#39;trial_type&#39;] = np.where(eventsnew[&#39;Trial_type&#39;].str.contains(&#39;mismatch&#39;), &#39;mismatch&#39;, &#39;match&#39;)</span>
<span class="c1"># eventsnew[&#39;onset&#39;] = events[&#39;onset&#39;] + 10.5</span>
<span class="c1"># eventsnew[&#39;duration&#39;] = 3.0</span>
<span class="c1"># eventsnew[&#39;response_time&#39;] = eventsnew[&#39;Resp_time&#39;]</span>
<span class="c1"># eventsnew[&#39;correct&#39;] = np.where(events[&#39;answer&#39;] == events[&#39;Response&#39;], &#39;Y&#39;, &#39;N&#39;)</span>
<span class="c1"># eventsnew = eventsnew[[&#39;onset&#39;, &#39;duration&#39;, &#39;trial_type&#39;, &#39;correct&#39;, &#39;response_time&#39;]]</span>
<span class="c1"># print(eventsnew)</span>

<span class="c1"># eventscue = events.copy()</span>
<span class="c1"># eventscue[&#39;trial_type&#39;] = &#39;cue&#39;</span>
<span class="c1"># eventscue[&#39;duration&#39;] = 6.0</span>
<span class="c1"># eventscue[&#39;onset&#39;] = events[&#39;onset&#39;] + 1.5</span>
<span class="c1"># eventscue[&#39;correct&#39;] = np.where(events[&#39;answer&#39;] == events[&#39;Response&#39;], &#39;Y&#39;, &#39;N&#39;)</span>
<span class="c1"># eventscue[&#39;response_time&#39;] = eventscue[&#39;Resp_time&#39;]</span>
<span class="c1"># eventscue = eventscue[[&#39;onset&#39;, &#39;duration&#39;, &#39;trial_type&#39;, &#39;correct&#39;, &#39;response_time&#39;]]</span>
<span class="c1"># print(eventscue)</span>

<span class="c1"># eventsn = pd.concat((eventscue, eventsnew))</span>
<span class="c1"># eventsn.to_csv(&#39;/Volumes/psybrain/ADM/sub-40782/func/sub-40782_task-MemMatch3_run-01_events.tsv&#39;)</span>
<span class="n">events</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">c</span><span class="o">/</span><span class="n">c825cr816cg14jn4bs40my5h0000gr</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_23755</span><span class="o">/</span><span class="mf">1130044639.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/sub-40782/func/sub-40782_task-MemMatch3_run-01_events.tsv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="c1"># eventsnew = events.copy()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># eventsnew[&#39;trial_type&#39;] = np.where(eventsnew[&#39;Trial_type&#39;].str.contains(&#39;mismatch&#39;), &#39;mismatch&#39;, &#39;match&#39;)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># eventsnew[&#39;onset&#39;] = events[&#39;onset&#39;] + 10.5</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1"># eventsnew[&#39;duration&#39;] = 3.0</span>

<span class="ne">NameError</span>: name &#39;pd&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="concatenate-runs-1-2-and-3-of-memmatch-task-in-4th-dimension-for-each-subject">
<h3>Concatenate runs 1, 2, and 3 of MemMatch task in 4th dimension for each subject<a class="headerlink" href="#concatenate-runs-1-2-and-3-of-memmatch-task-in-4th-dimension-for-each-subject" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>

out_dir=/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries

for subject in `cat /Volumes/psybrain/ADM/derivatives/nibs/subjects.txt`; do
    echo $subject
    if [ ! -f ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz ]; then
      fslmerge -t ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
      fslmerge -t ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz
      fslmerge -t ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz
      fi
done
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30004
30008
30009
30015
30019
30020
30023
30040
30057
30064
30066
30069
30074
30085
30088
30090
30091
30095
30096
30105
30116
30118
30119
30128
30181
30217
30227
30236
30242
30255
30274
30283
30295
30330
30346
30376
30395
30400
30403
30412
30426
30432
30466
30469
30476
30478
30568
30570
30581
30584
30588
40160
40170
40175
40288
40351
40490
40512
40519
40520
40524
40547
40564
40615
40619
40624
40638
40649
40650
40656
40658
40664
40665
40668
40672
40685
40694
40720
40738
40743
40750
40773
40778
40796
40803
40855
40861
40930
40961
40968
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Image Exception : #63 :: No image files match: /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40930/func/sub-40930_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries
libc++abi.dylib: terminating with uncaught exception of type std::runtime_error: No image files match: /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40930/func/sub-40930_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries
bash: line 4: 65371 Abort trap: 6           fslmerge -t ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
Image Exception : #63 :: No image files match: /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40930/func/sub-40930_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries
libc++abi.dylib: terminating with uncaught exception of type std::runtime_error: No image files match: /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40930/func/sub-40930_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries
bash: line 4: 65372 Abort trap: 6           fslmerge -t ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz
Image Exception : #63 :: No image files match: /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40930/func/sub-40930_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries
libc++abi.dylib: terminating with uncaught exception of type std::runtime_error: No image files match: /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40930/func/sub-40930_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries
bash: line 4: 65373 Abort trap: 6           fslmerge -t ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch1_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch2_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz ${out_dir}/sub-${subject}/func/sub-${subject}_task-MemMatch3_run-1_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
out_dir=/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries
ls ${out_dir}/sub-*/func/sub-*_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz | wc -l
ls ${out_dir}/sub-3*/func/sub-3*_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz | wc -l
ls ${out_dir}/sub-4*/func/sub-4*_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz | wc -l
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      89
      51
      38
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subjects</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;sub-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">nibs_dir</span> <span class="o">+</span> <span class="s1">&#39;/sub-*&#39;</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subjects</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;40778&#39;, &#39;40796&#39;, &#39;40803&#39;, &#39;40855&#39;, &#39;40861&#39;, &#39;40961&#39;, &#39;40968&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Power atlas&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays.OrthoSlicer at 0x1d4f6d950&gt;
</pre></div>
</div>
<img alt="_images/nibetaseries_33_1.png" src="_images/nibetaseries_33_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coords</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-21, -22, -20])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.connectome</span> <span class="kn">import</span> <span class="n">ConnectivityMeasure</span>
<span class="kn">from</span> <span class="nn">sklearn.covariance</span> <span class="kn">import</span> <span class="n">EmpiricalCovariance</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mne.viz</span> <span class="kn">import</span> <span class="n">plot_connectivity_circle</span>
<span class="kn">import</span> <span class="nn">re</span>


<span class="k">def</span> <span class="nf">_fisher_r_to_z</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="c1"># correct any rounding errors</span>
    <span class="c1"># correlations cannot be greater than 1.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arctanh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">subjects</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">:]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
    <span class="n">out_dir</span><span class="o">=</span><span class="n">nibs_dir</span> <span class="o">+</span> <span class="s1">&#39;/sub-&#39;</span> <span class="o">+</span> <span class="n">subject</span> <span class="o">+</span> <span class="s1">&#39;/func/&#39;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">trial_type</span> <span class="ow">in</span> <span class="n">trial_types</span><span class="p">:</span>
        <span class="c1"># extract timeseries from every label</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s1">&#39;sub-&#39;</span> <span class="o">+</span> <span class="n">subject</span> <span class="o">+</span> <span class="s1">&#39;_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-&#39;</span> <span class="o">+</span> <span class="n">trial_type</span> <span class="o">+</span> <span class="s1">&#39;_correlation.tsv&#39;</span><span class="p">)):</span>
            
            <span class="k">try</span><span class="p">:</span> 
                <span class="n">timeseries_file</span><span class="o">=</span> <span class="n">out_dir</span> <span class="o">+</span> <span class="s1">&#39;sub-&#39;</span> <span class="o">+</span> <span class="n">subject</span> <span class="o">+</span> <span class="s1">&#39;_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-&#39;</span> <span class="o">+</span> <span class="n">trial_type</span> <span class="o">+</span> <span class="s1">&#39;_betaseries.nii.gz&#39;</span>

                <span class="n">masker</span> <span class="o">=</span> <span class="n">NiftiLabelsMasker</span><span class="p">(</span><span class="n">labels_img</span><span class="o">=</span><span class="n">atlas_file</span><span class="p">,</span>
                                           <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">timeseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">timeseries_file</span><span class="p">)</span>
                <span class="c1"># create correlation matrix</span>
                <span class="n">correlation_measure</span> <span class="o">=</span> <span class="n">ConnectivityMeasure</span><span class="p">(</span><span class="n">cov_estimator</span><span class="o">=</span><span class="n">EmpiricalCovariance</span><span class="p">(),</span>
                                                          <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;correlation&quot;</span><span class="p">)</span>
                <span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">correlation_measure</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="n">timeseries</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>

                <span class="c1"># add the atlas labels to the matrix</span>
                <span class="n">atlas_lut_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">atlas_lut</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">regions</span> <span class="o">=</span> <span class="n">atlas_lut_df</span><span class="p">[</span><span class="s1">&#39;regions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">correlation_matrix_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">regions</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">regions</span><span class="p">)</span>

                <span class="c1"># do a fisher&#39;s r -&gt; z transform</span>
                <span class="n">fisher_z_matrix_df</span> <span class="o">=</span> <span class="n">correlation_matrix_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_fisher_r_to_z</span><span class="p">)</span>

                <span class="c1"># write out the file.</span>

                <span class="n">corr_mat_fname</span> <span class="o">=</span> <span class="s1">&#39;sub-&#39;</span> <span class="o">+</span> <span class="n">subject</span> <span class="o">+</span> <span class="s1">&#39;_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-&#39;</span> <span class="o">+</span> <span class="n">trial_type</span> <span class="o">+</span> <span class="s1">&#39;_correlation.tsv&#39;</span>
                <span class="n">corr_mat_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">corr_mat_fname</span><span class="p">)</span>
                <span class="n">fisher_z_matrix_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">corr_mat_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">na_rep</span><span class="o">=</span><span class="s1">&#39;n/a&#39;</span><span class="p">)</span>

                <span class="c1"># visualizations with mne</span>
                <span class="n">connmat</span> <span class="o">=</span> <span class="n">fisher_z_matrix_df</span><span class="o">.</span><span class="n">values</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fisher_z_matrix_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                <span class="c1"># plot a circle visualization of the correlation matrix</span>
                <span class="n">viz_mat_fname</span> <span class="o">=</span> <span class="s1">&#39;sub-&#39;</span> <span class="o">+</span> <span class="n">subject</span> <span class="o">+</span> <span class="s1">&#39;_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-&#39;</span> <span class="o">+</span> <span class="n">trial_type</span> <span class="o">+</span> <span class="s1">&#39;_correlation.svg&#39;</span>
                <span class="n">viz_mat_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">viz_mat_fname</span><span class="p">)</span>

                <span class="n">n_lines</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">connmat</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

                <span class="n">plot_connectivity_circle</span><span class="p">(</span><span class="n">connmat</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">n_lines</span><span class="o">=</span><span class="n">n_lines</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;correlation </span><span class="si">%s</span><span class="s1"> concat&#39;</span> <span class="o">%</span> <span class="n">trial_type</span><span class="p">,</span>
                                         <span class="n">fontsize_title</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">textcolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                                         <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">node_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span>
                                         <span class="n">node_edgecolor</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">viz_mat_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40778
[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40778/func/sub-40778_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40778/func/sub-40778_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40778/func/sub-40778_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40796
[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40796/func/sub-40796_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40796/func/sub-40796_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40796/func/sub-40796_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40803
[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40803/func/sub-40803_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/PSYC-mcm5324/Library/Python/3.7/lib/python/site-packages/nilearn/connectome/connectivity_matrices.py:359: RuntimeWarning: divide by zero encountered in true_divide
  diagonal = np.atleast_2d(1. / np.sqrt(np.diag(covariance)))
/Users/PSYC-mcm5324/Library/Python/3.7/lib/python/site-packages/nilearn/connectome/connectivity_matrices.py:360: RuntimeWarning: invalid value encountered in multiply
  correlation = covariance * diagonal * diagonal.T
/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
/usr/local/lib/python3.7/site-packages/mne/viz/circle.py:305: RuntimeWarning: invalid value encountered in greater_equal
  con_draw_idx = np.where(con_abs &gt;= con_thresh)[0]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40803/func/sub-40803_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/PSYC-mcm5324/Library/Python/3.7/lib/python/site-packages/nilearn/connectome/connectivity_matrices.py:359: RuntimeWarning: divide by zero encountered in true_divide
  diagonal = np.atleast_2d(1. / np.sqrt(np.diag(covariance)))
/Users/PSYC-mcm5324/Library/Python/3.7/lib/python/site-packages/nilearn/connectome/connectivity_matrices.py:360: RuntimeWarning: invalid value encountered in multiply
  correlation = covariance * diagonal * diagonal.T
/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
/usr/local/lib/python3.7/site-packages/mne/viz/circle.py:305: RuntimeWarning: invalid value encountered in greater_equal
  con_draw_idx = np.where(con_abs &gt;= con_thresh)[0]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40803/func/sub-40803_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/PSYC-mcm5324/Library/Python/3.7/lib/python/site-packages/nilearn/connectome/connectivity_matrices.py:359: RuntimeWarning: divide by zero encountered in true_divide
  diagonal = np.atleast_2d(1. / np.sqrt(np.diag(covariance)))
/Users/PSYC-mcm5324/Library/Python/3.7/lib/python/site-packages/nilearn/connectome/connectivity_matrices.py:360: RuntimeWarning: invalid value encountered in multiply
  correlation = covariance * diagonal * diagonal.T
/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
/usr/local/lib/python3.7/site-packages/mne/viz/circle.py:305: RuntimeWarning: invalid value encountered in greater_equal
  con_draw_idx = np.where(con_abs &gt;= con_thresh)[0]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40855
[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40855/func/sub-40855_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40855/func/sub-40855_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40855/func/sub-40855_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40861
[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40861/func/sub-40861_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40861/func/sub-40861_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40861/func/sub-40861_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40961
[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40961/func/sub-40961_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40961/func/sub-40961_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40961/func/sub-40961_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40968
[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40968/func/sub-40968_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40968/func/sub-40968_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-match_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NiftiLabelsMasker.fit_transform] loading data from /Volumes/psybrain/ADM/derivatives/nibs/power264-master/power264MNI.nii.gz
Resampling labels
[NiftiLabelsMasker.transform_single_imgs] Loading data from /Volumes/psybrain/ADM/derivatives/nibs/nibetaseries/sub-40968/func/sub-40968_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-mismatch_betaseries.nii.gz
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:64: RuntimeWarning: invalid value encountered in greater
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://sites.google.com/site/bctnet/Home/help">BCT User Guide</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">nibs_dir</span> <span class="o">+</span> <span class="s1">&#39;/sub-*/func/sub-*_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30096/func/sub-30096_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30432/func/sub-30432_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30074/func/sub-30074_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30330/func/sub-30330_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30009/func/sub-30009_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30181/func/sub-30181_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40175/func/sub-40175_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30476/func/sub-30476_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30015/func/sub-30015_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30128/func/sub-30128_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30095/func/sub-30095_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30295/func/sub-30295_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30119/func/sub-30119_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30064/func/sub-30064_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30217/func/sub-30217_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40619/func/sub-40619_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40490/func/sub-40490_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30091/func/sub-30091_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30057/func/sub-30057_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40170/func/sub-40170_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30400/func/sub-30400_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40615/func/sub-40615_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30581/func/sub-30581_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30023/func/sub-30023_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40564/func/sub-40564_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30478/func/sub-30478_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30105/func/sub-30105_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30568/func/sub-30568_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30085/func/sub-30085_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30116/func/sub-30116_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40512/func/sub-40512_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30088/func/sub-30088_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40160/func/sub-40160_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30584/func/sub-30584_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30346/func/sub-30346_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30426/func/sub-30426_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30227/func/sub-30227_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30466/func/sub-30466_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30588/func/sub-30588_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40624/func/sub-40624_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40519/func/sub-40519_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30395/func/sub-30395_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30020/func/sub-30020_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30274/func/sub-30274_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40524/func/sub-40524_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30412/func/sub-30412_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30118/func/sub-30118_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30570/func/sub-30570_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30236/func/sub-30236_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30069/func/sub-30069_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30283/func/sub-30283_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30469/func/sub-30469_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40351/func/sub-40351_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30403/func/sub-30403_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30040/func/sub-30040_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40520/func/sub-40520_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30242/func/sub-30242_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30376/func/sub-30376_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40288/func/sub-40288_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30066/func/sub-30066_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30008/func/sub-30008_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-40547/func/sub-40547_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30004/func/sub-30004_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;,
 &#39;/Volumes/psybrain/ADM/derivatives/nibs/nibetaseries_old/sub-30019/func/sub-30019_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-cue_correlation.tsv&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">fc_subs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">trial_type</span> <span class="ow">in</span> <span class="n">trial_types</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">trial_type</span><span class="p">)</span>
    <span class="n">corfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">nibs_dir</span> <span class="o">+</span> <span class="s1">&#39;/sub-*/func/sub-*_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-</span><span class="si">%s</span><span class="s1">_correlation.tsv&#39;</span> <span class="o">%</span> <span class="n">trial_type</span><span class="p">)</span>
    <span class="n">corfiles_ya</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">nibs_dir</span> <span class="o">+</span> <span class="s1">&#39;/sub-3*/func/sub-3*_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-</span><span class="si">%s</span><span class="s1">_correlation.tsv&#39;</span> <span class="o">%</span> <span class="n">trial_type</span><span class="p">)</span>
    <span class="n">corfiles_oa</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">nibs_dir</span> <span class="o">+</span> <span class="s1">&#39;/sub-4*/func/sub-4*_task-MemMatch_run-concat_space-MNI152NLin2009cAsym_desc-</span><span class="si">%s</span><span class="s1">_correlation.tsv&#39;</span> <span class="o">%</span> <span class="n">trial_type</span><span class="p">)</span>
    
    <span class="n">x</span><span class="p">[</span><span class="n">trial_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">264</span><span class="p">,</span><span class="mi">264</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corfiles</span><span class="p">)))</span>
    <span class="n">x</span><span class="p">[</span><span class="n">trial_type</span> <span class="o">+</span> <span class="s1">&#39;_ya&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">264</span><span class="p">,</span><span class="mi">264</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corfiles_ya</span><span class="p">)))</span>
    <span class="n">x</span><span class="p">[</span><span class="n">trial_type</span> <span class="o">+</span> <span class="s1">&#39;_oa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">264</span><span class="p">,</span><span class="mi">264</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corfiles_oa</span><span class="p">)))</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">corfiles</span><span class="p">):</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;sub-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">subject</span> <span class="o">!=</span> <span class="s1">&#39;30476&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;n/a&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i = %.f&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">x</span><span class="p">[</span><span class="n">trial_type</span><span class="p">][:,:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;n/a&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span>
            <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">trial_type</span><span class="p">][:,:,</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">trial_type</span><span class="p">][:,:,</span><span class="n">i</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            
            <span class="n">fc_subs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">subject</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">40000</span><span class="p">:</span>
                <span class="n">x</span><span class="p">[</span><span class="n">trial_type</span> <span class="o">+</span> <span class="s1">&#39;_ya&#39;</span><span class="p">][:,:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;n/a&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span>
                <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">trial_type</span> <span class="o">+</span> <span class="s1">&#39;_ya&#39;</span><span class="p">][:,:,</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;j = %.f </span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">j</span><span class="p">)</span>
                <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span><span class="p">[</span><span class="n">trial_type</span> <span class="o">+</span> <span class="s1">&#39;_oa&#39;</span><span class="p">][:,:,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;n/a&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span>    
                <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">trial_type</span> <span class="o">+</span> <span class="s1">&#39;_oa&#39;</span><span class="p">][:,:,</span><span class="n">k</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;k = %.f </span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span>
                <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>

            <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/fcsubs.txt&#39;</span><span class="p">,</span> <span class="n">fc_subs</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/memmatch_fc.npy&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">savemat</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/memmatch_fc.mat&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cue
30004
(264, 264)
i = 0
</pre></div>
</div>
<img alt="_images/nibetaseries_39_1.png" src="_images/nibetaseries_39_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 0 


30008
(264, 264)
i = 1
</pre></div>
</div>
<img alt="_images/nibetaseries_39_3.png" src="_images/nibetaseries_39_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 1 


30009
(264, 264)
i = 2
</pre></div>
</div>
<img alt="_images/nibetaseries_39_5.png" src="_images/nibetaseries_39_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 2 


30015
(264, 264)
i = 3
</pre></div>
</div>
<img alt="_images/nibetaseries_39_7.png" src="_images/nibetaseries_39_7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 3 


30019
(264, 264)
i = 4
</pre></div>
</div>
<img alt="_images/nibetaseries_39_9.png" src="_images/nibetaseries_39_9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 4 


30020
(264, 264)
i = 5
</pre></div>
</div>
<img alt="_images/nibetaseries_39_11.png" src="_images/nibetaseries_39_11.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 5 


30023
(264, 264)
i = 6
</pre></div>
</div>
<img alt="_images/nibetaseries_39_13.png" src="_images/nibetaseries_39_13.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 6 


30040
(264, 264)
i = 7
</pre></div>
</div>
<img alt="_images/nibetaseries_39_15.png" src="_images/nibetaseries_39_15.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 7 


30057
(264, 264)
i = 8
</pre></div>
</div>
<img alt="_images/nibetaseries_39_17.png" src="_images/nibetaseries_39_17.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 8 


30064
(264, 264)
i = 9
</pre></div>
</div>
<img alt="_images/nibetaseries_39_19.png" src="_images/nibetaseries_39_19.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 9 


30066
(264, 264)
i = 10
</pre></div>
</div>
<img alt="_images/nibetaseries_39_21.png" src="_images/nibetaseries_39_21.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 10 


30069
(264, 264)
i = 11
</pre></div>
</div>
<img alt="_images/nibetaseries_39_23.png" src="_images/nibetaseries_39_23.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 11 


30074
(264, 264)
i = 12
</pre></div>
</div>
<img alt="_images/nibetaseries_39_25.png" src="_images/nibetaseries_39_25.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 12 


30085
(264, 264)
i = 13
</pre></div>
</div>
<img alt="_images/nibetaseries_39_27.png" src="_images/nibetaseries_39_27.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 13 


30088
(264, 264)
i = 14
</pre></div>
</div>
<img alt="_images/nibetaseries_39_29.png" src="_images/nibetaseries_39_29.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 14 


30090
(264, 264)
i = 15
</pre></div>
</div>
<img alt="_images/nibetaseries_39_31.png" src="_images/nibetaseries_39_31.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 15 


30091
(264, 264)
i = 16
</pre></div>
</div>
<img alt="_images/nibetaseries_39_33.png" src="_images/nibetaseries_39_33.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 16 


30095
(264, 264)
i = 17
</pre></div>
</div>
<img alt="_images/nibetaseries_39_35.png" src="_images/nibetaseries_39_35.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 17 


30096
(264, 264)
i = 18
</pre></div>
</div>
<img alt="_images/nibetaseries_39_37.png" src="_images/nibetaseries_39_37.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 18 


30105
(264, 264)
i = 19
</pre></div>
</div>
<img alt="_images/nibetaseries_39_39.png" src="_images/nibetaseries_39_39.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 19 


30116
(264, 264)
i = 20
</pre></div>
</div>
<img alt="_images/nibetaseries_39_41.png" src="_images/nibetaseries_39_41.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 20 


30118
(264, 264)
i = 21
</pre></div>
</div>
<img alt="_images/nibetaseries_39_43.png" src="_images/nibetaseries_39_43.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 21 


30119
(264, 264)
i = 22
</pre></div>
</div>
<img alt="_images/nibetaseries_39_45.png" src="_images/nibetaseries_39_45.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 22 


30128
(264, 264)
i = 23
</pre></div>
</div>
<img alt="_images/nibetaseries_39_47.png" src="_images/nibetaseries_39_47.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 23 


30181
(264, 264)
i = 24
</pre></div>
</div>
<img alt="_images/nibetaseries_39_49.png" src="_images/nibetaseries_39_49.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 24 


30217
(264, 264)
i = 25
</pre></div>
</div>
<img alt="_images/nibetaseries_39_51.png" src="_images/nibetaseries_39_51.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 25 


30227
(264, 264)
i = 26
</pre></div>
</div>
<img alt="_images/nibetaseries_39_53.png" src="_images/nibetaseries_39_53.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 26 


30236
(264, 264)
i = 27
</pre></div>
</div>
<img alt="_images/nibetaseries_39_55.png" src="_images/nibetaseries_39_55.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 27 


30242
(264, 264)
i = 28
</pre></div>
</div>
<img alt="_images/nibetaseries_39_57.png" src="_images/nibetaseries_39_57.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 28 


30255
(264, 264)
i = 29
</pre></div>
</div>
<img alt="_images/nibetaseries_39_59.png" src="_images/nibetaseries_39_59.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 29 


30274
(264, 264)
i = 30
</pre></div>
</div>
<img alt="_images/nibetaseries_39_61.png" src="_images/nibetaseries_39_61.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 30 


30283
(264, 264)
i = 31
</pre></div>
</div>
<img alt="_images/nibetaseries_39_63.png" src="_images/nibetaseries_39_63.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 31 


30295
(264, 264)
i = 32
</pre></div>
</div>
<img alt="_images/nibetaseries_39_65.png" src="_images/nibetaseries_39_65.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 32 


30330
(264, 264)
i = 33
</pre></div>
</div>
<img alt="_images/nibetaseries_39_67.png" src="_images/nibetaseries_39_67.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 33 


30346
(264, 264)
i = 34
</pre></div>
</div>
<img alt="_images/nibetaseries_39_69.png" src="_images/nibetaseries_39_69.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 34 


30376
(264, 264)
i = 35
</pre></div>
</div>
<img alt="_images/nibetaseries_39_71.png" src="_images/nibetaseries_39_71.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 35 


30395
(264, 264)
i = 36
</pre></div>
</div>
<img alt="_images/nibetaseries_39_73.png" src="_images/nibetaseries_39_73.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 36 


30400
(264, 264)
i = 37
</pre></div>
</div>
<img alt="_images/nibetaseries_39_75.png" src="_images/nibetaseries_39_75.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 37 


30403
(264, 264)
i = 38
</pre></div>
</div>
<img alt="_images/nibetaseries_39_77.png" src="_images/nibetaseries_39_77.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 38 


30412
(264, 264)
i = 39
</pre></div>
</div>
<img alt="_images/nibetaseries_39_79.png" src="_images/nibetaseries_39_79.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 39 


30426
(264, 264)
i = 40
</pre></div>
</div>
<img alt="_images/nibetaseries_39_81.png" src="_images/nibetaseries_39_81.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 40 


30432
(264, 264)
i = 41
</pre></div>
</div>
<img alt="_images/nibetaseries_39_83.png" src="_images/nibetaseries_39_83.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 41 


30466
(264, 264)
i = 42
</pre></div>
</div>
<img alt="_images/nibetaseries_39_85.png" src="_images/nibetaseries_39_85.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 42 


30469
(264, 264)
i = 43
</pre></div>
</div>
<img alt="_images/nibetaseries_39_87.png" src="_images/nibetaseries_39_87.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 43 


30476
30478
(264, 264)
i = 44
</pre></div>
</div>
<img alt="_images/nibetaseries_39_89.png" src="_images/nibetaseries_39_89.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 44 


30568
(264, 264)
i = 45
</pre></div>
</div>
<img alt="_images/nibetaseries_39_91.png" src="_images/nibetaseries_39_91.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 45 


30570
(264, 264)
i = 46
</pre></div>
</div>
<img alt="_images/nibetaseries_39_93.png" src="_images/nibetaseries_39_93.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 46 


30581
(264, 264)
i = 47
</pre></div>
</div>
<img alt="_images/nibetaseries_39_95.png" src="_images/nibetaseries_39_95.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 47 


30584
(264, 264)
i = 48
</pre></div>
</div>
<img alt="_images/nibetaseries_39_97.png" src="_images/nibetaseries_39_97.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 48 


30588
(264, 264)
i = 49
</pre></div>
</div>
<img alt="_images/nibetaseries_39_99.png" src="_images/nibetaseries_39_99.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 49 


40160
(264, 264)
i = 50
</pre></div>
</div>
<img alt="_images/nibetaseries_39_101.png" src="_images/nibetaseries_39_101.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 0 


40170
(264, 264)
i = 51
</pre></div>
</div>
<img alt="_images/nibetaseries_39_103.png" src="_images/nibetaseries_39_103.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 1 


40175
(264, 264)
i = 52
</pre></div>
</div>
<img alt="_images/nibetaseries_39_105.png" src="_images/nibetaseries_39_105.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 2 


40288
(264, 264)
i = 53
</pre></div>
</div>
<img alt="_images/nibetaseries_39_107.png" src="_images/nibetaseries_39_107.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 3 


40351
(264, 264)
i = 54
</pre></div>
</div>
<img alt="_images/nibetaseries_39_109.png" src="_images/nibetaseries_39_109.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 4 


40490
(264, 264)
i = 55
</pre></div>
</div>
<img alt="_images/nibetaseries_39_111.png" src="_images/nibetaseries_39_111.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 5 


40512
(264, 264)
i = 56
</pre></div>
</div>
<img alt="_images/nibetaseries_39_113.png" src="_images/nibetaseries_39_113.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 6 


40519
(264, 264)
i = 57
</pre></div>
</div>
<img alt="_images/nibetaseries_39_115.png" src="_images/nibetaseries_39_115.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 7 


40520
(264, 264)
i = 58
</pre></div>
</div>
<img alt="_images/nibetaseries_39_117.png" src="_images/nibetaseries_39_117.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 8 


40524
(264, 264)
i = 59
</pre></div>
</div>
<img alt="_images/nibetaseries_39_119.png" src="_images/nibetaseries_39_119.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 9 


40547
(264, 264)
i = 60
</pre></div>
</div>
<img alt="_images/nibetaseries_39_121.png" src="_images/nibetaseries_39_121.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 10 


40564
(264, 264)
i = 61
</pre></div>
</div>
<img alt="_images/nibetaseries_39_123.png" src="_images/nibetaseries_39_123.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 11 


40615
(264, 264)
i = 62
</pre></div>
</div>
<img alt="_images/nibetaseries_39_125.png" src="_images/nibetaseries_39_125.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 12 


40619
(264, 264)
i = 63
</pre></div>
</div>
<img alt="_images/nibetaseries_39_127.png" src="_images/nibetaseries_39_127.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 13 


40624
(264, 264)
i = 64
</pre></div>
</div>
<img alt="_images/nibetaseries_39_129.png" src="_images/nibetaseries_39_129.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 14 


40638
(264, 264)
i = 65
</pre></div>
</div>
<img alt="_images/nibetaseries_39_131.png" src="_images/nibetaseries_39_131.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 15 


40649
(264, 264)
i = 66
</pre></div>
</div>
<img alt="_images/nibetaseries_39_133.png" src="_images/nibetaseries_39_133.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 16 


40650
(264, 264)
i = 67
</pre></div>
</div>
<img alt="_images/nibetaseries_39_135.png" src="_images/nibetaseries_39_135.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 17 


40656
(264, 264)
i = 68
</pre></div>
</div>
<img alt="_images/nibetaseries_39_137.png" src="_images/nibetaseries_39_137.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 18 


40658
(264, 264)
i = 69
</pre></div>
</div>
<img alt="_images/nibetaseries_39_139.png" src="_images/nibetaseries_39_139.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 19 


40664
(264, 264)
i = 70
</pre></div>
</div>
<img alt="_images/nibetaseries_39_141.png" src="_images/nibetaseries_39_141.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 20 


40665
(264, 264)
i = 71
</pre></div>
</div>
<img alt="_images/nibetaseries_39_143.png" src="_images/nibetaseries_39_143.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 21 


40668
(264, 264)
i = 72
</pre></div>
</div>
<img alt="_images/nibetaseries_39_145.png" src="_images/nibetaseries_39_145.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 22 


40672
(264, 264)
i = 73
</pre></div>
</div>
<img alt="_images/nibetaseries_39_147.png" src="_images/nibetaseries_39_147.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 23 


40685
(264, 264)
i = 74
</pre></div>
</div>
<img alt="_images/nibetaseries_39_149.png" src="_images/nibetaseries_39_149.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 24 


40694
(264, 264)
i = 75
</pre></div>
</div>
<img alt="_images/nibetaseries_39_151.png" src="_images/nibetaseries_39_151.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 25 


40720
(264, 264)
i = 76
</pre></div>
</div>
<img alt="_images/nibetaseries_39_153.png" src="_images/nibetaseries_39_153.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 26 


40738
(264, 264)
i = 77
</pre></div>
</div>
<img alt="_images/nibetaseries_39_155.png" src="_images/nibetaseries_39_155.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 27 


40743
(264, 264)
i = 78
</pre></div>
</div>
<img alt="_images/nibetaseries_39_157.png" src="_images/nibetaseries_39_157.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 28 


40750
(264, 264)
i = 79
</pre></div>
</div>
<img alt="_images/nibetaseries_39_159.png" src="_images/nibetaseries_39_159.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 29 


40778
(264, 264)
i = 80
</pre></div>
</div>
<img alt="_images/nibetaseries_39_161.png" src="_images/nibetaseries_39_161.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 30 


40796
(264, 264)
i = 81
</pre></div>
</div>
<img alt="_images/nibetaseries_39_163.png" src="_images/nibetaseries_39_163.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 31 


40803
(264, 264)
i = 82
</pre></div>
</div>
<img alt="_images/nibetaseries_39_165.png" src="_images/nibetaseries_39_165.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 32 


40855
(264, 264)
i = 83
</pre></div>
</div>
<img alt="_images/nibetaseries_39_167.png" src="_images/nibetaseries_39_167.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 33 


40861
(264, 264)
i = 84
</pre></div>
</div>
<img alt="_images/nibetaseries_39_169.png" src="_images/nibetaseries_39_169.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 34 


40961
(264, 264)
i = 85
</pre></div>
</div>
<img alt="_images/nibetaseries_39_171.png" src="_images/nibetaseries_39_171.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 35 


40968
(264, 264)
i = 86
</pre></div>
</div>
<img alt="_images/nibetaseries_39_173.png" src="_images/nibetaseries_39_173.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 36 



match
30004
(264, 264)
i = 0
</pre></div>
</div>
<img alt="_images/nibetaseries_39_175.png" src="_images/nibetaseries_39_175.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 0 


30008
(264, 264)
i = 1
</pre></div>
</div>
<img alt="_images/nibetaseries_39_177.png" src="_images/nibetaseries_39_177.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 1 


30009
(264, 264)
i = 2
</pre></div>
</div>
<img alt="_images/nibetaseries_39_179.png" src="_images/nibetaseries_39_179.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 2 


30015
(264, 264)
i = 3
</pre></div>
</div>
<img alt="_images/nibetaseries_39_181.png" src="_images/nibetaseries_39_181.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 3 


30019
(264, 264)
i = 4
</pre></div>
</div>
<img alt="_images/nibetaseries_39_183.png" src="_images/nibetaseries_39_183.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 4 


30020
(264, 264)
i = 5
</pre></div>
</div>
<img alt="_images/nibetaseries_39_185.png" src="_images/nibetaseries_39_185.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 5 


30023
(264, 264)
i = 6
</pre></div>
</div>
<img alt="_images/nibetaseries_39_187.png" src="_images/nibetaseries_39_187.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 6 


30040
(264, 264)
i = 7
</pre></div>
</div>
<img alt="_images/nibetaseries_39_189.png" src="_images/nibetaseries_39_189.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 7 


30057
(264, 264)
i = 8
</pre></div>
</div>
<img alt="_images/nibetaseries_39_191.png" src="_images/nibetaseries_39_191.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 8 


30064
(264, 264)
i = 9
</pre></div>
</div>
<img alt="_images/nibetaseries_39_193.png" src="_images/nibetaseries_39_193.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 9 


30066
(264, 264)
i = 10
</pre></div>
</div>
<img alt="_images/nibetaseries_39_195.png" src="_images/nibetaseries_39_195.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 10 


30069
(264, 264)
i = 11
</pre></div>
</div>
<img alt="_images/nibetaseries_39_197.png" src="_images/nibetaseries_39_197.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 11 


30074
(264, 264)
i = 12
</pre></div>
</div>
<img alt="_images/nibetaseries_39_199.png" src="_images/nibetaseries_39_199.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 12 


30085
(264, 264)
i = 13
</pre></div>
</div>
<img alt="_images/nibetaseries_39_201.png" src="_images/nibetaseries_39_201.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 13 


30088
(264, 264)
i = 14
</pre></div>
</div>
<img alt="_images/nibetaseries_39_203.png" src="_images/nibetaseries_39_203.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 14 


30090
(264, 264)
i = 15
</pre></div>
</div>
<img alt="_images/nibetaseries_39_205.png" src="_images/nibetaseries_39_205.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 15 


30091
(264, 264)
i = 16
</pre></div>
</div>
<img alt="_images/nibetaseries_39_207.png" src="_images/nibetaseries_39_207.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 16 


30095
(264, 264)
i = 17
</pre></div>
</div>
<img alt="_images/nibetaseries_39_209.png" src="_images/nibetaseries_39_209.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 17 


30096
(264, 264)
i = 18
</pre></div>
</div>
<img alt="_images/nibetaseries_39_211.png" src="_images/nibetaseries_39_211.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 18 


30105
(264, 264)
i = 19
</pre></div>
</div>
<img alt="_images/nibetaseries_39_213.png" src="_images/nibetaseries_39_213.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 19 


30116
(264, 264)
i = 20
</pre></div>
</div>
<img alt="_images/nibetaseries_39_215.png" src="_images/nibetaseries_39_215.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 20 


30118
(264, 264)
i = 21
</pre></div>
</div>
<img alt="_images/nibetaseries_39_217.png" src="_images/nibetaseries_39_217.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 21 


30119
(264, 264)
i = 22
</pre></div>
</div>
<img alt="_images/nibetaseries_39_219.png" src="_images/nibetaseries_39_219.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 22 


30128
(264, 264)
i = 23
</pre></div>
</div>
<img alt="_images/nibetaseries_39_221.png" src="_images/nibetaseries_39_221.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 23 


30181
(264, 264)
i = 24
</pre></div>
</div>
<img alt="_images/nibetaseries_39_223.png" src="_images/nibetaseries_39_223.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 24 


30217
(264, 264)
i = 25
</pre></div>
</div>
<img alt="_images/nibetaseries_39_225.png" src="_images/nibetaseries_39_225.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 25 


30227
(264, 264)
i = 26
</pre></div>
</div>
<img alt="_images/nibetaseries_39_227.png" src="_images/nibetaseries_39_227.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 26 


30236
(264, 264)
i = 27
</pre></div>
</div>
<img alt="_images/nibetaseries_39_229.png" src="_images/nibetaseries_39_229.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 27 


30242
(264, 264)
i = 28
</pre></div>
</div>
<img alt="_images/nibetaseries_39_231.png" src="_images/nibetaseries_39_231.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 28 


30255
(264, 264)
i = 29
</pre></div>
</div>
<img alt="_images/nibetaseries_39_233.png" src="_images/nibetaseries_39_233.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 29 


30274
(264, 264)
i = 30
</pre></div>
</div>
<img alt="_images/nibetaseries_39_235.png" src="_images/nibetaseries_39_235.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 30 


30283
(264, 264)
i = 31
</pre></div>
</div>
<img alt="_images/nibetaseries_39_237.png" src="_images/nibetaseries_39_237.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 31 


30295
(264, 264)
i = 32
</pre></div>
</div>
<img alt="_images/nibetaseries_39_239.png" src="_images/nibetaseries_39_239.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 32 


30330
(264, 264)
i = 33
</pre></div>
</div>
<img alt="_images/nibetaseries_39_241.png" src="_images/nibetaseries_39_241.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 33 


30346
(264, 264)
i = 34
</pre></div>
</div>
<img alt="_images/nibetaseries_39_243.png" src="_images/nibetaseries_39_243.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 34 


30376
(264, 264)
i = 35
</pre></div>
</div>
<img alt="_images/nibetaseries_39_245.png" src="_images/nibetaseries_39_245.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 35 


30395
(264, 264)
i = 36
</pre></div>
</div>
<img alt="_images/nibetaseries_39_247.png" src="_images/nibetaseries_39_247.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 36 


30400
(264, 264)
i = 37
</pre></div>
</div>
<img alt="_images/nibetaseries_39_249.png" src="_images/nibetaseries_39_249.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 37 


30403
(264, 264)
i = 38
</pre></div>
</div>
<img alt="_images/nibetaseries_39_251.png" src="_images/nibetaseries_39_251.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 38 


30412
(264, 264)
i = 39
</pre></div>
</div>
<img alt="_images/nibetaseries_39_253.png" src="_images/nibetaseries_39_253.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 39 


30426
(264, 264)
i = 40
</pre></div>
</div>
<img alt="_images/nibetaseries_39_255.png" src="_images/nibetaseries_39_255.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 40 


30432
(264, 264)
i = 41
</pre></div>
</div>
<img alt="_images/nibetaseries_39_257.png" src="_images/nibetaseries_39_257.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 41 


30466
(264, 264)
i = 42
</pre></div>
</div>
<img alt="_images/nibetaseries_39_259.png" src="_images/nibetaseries_39_259.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 42 


30469
(264, 264)
i = 43
</pre></div>
</div>
<img alt="_images/nibetaseries_39_261.png" src="_images/nibetaseries_39_261.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 43 


30476
30478
(264, 264)
i = 44
</pre></div>
</div>
<img alt="_images/nibetaseries_39_263.png" src="_images/nibetaseries_39_263.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 44 


30568
(264, 264)
i = 45
</pre></div>
</div>
<img alt="_images/nibetaseries_39_265.png" src="_images/nibetaseries_39_265.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 45 


30570
(264, 264)
i = 46
</pre></div>
</div>
<img alt="_images/nibetaseries_39_267.png" src="_images/nibetaseries_39_267.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 46 


30581
(264, 264)
i = 47
</pre></div>
</div>
<img alt="_images/nibetaseries_39_269.png" src="_images/nibetaseries_39_269.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 47 


30584
(264, 264)
i = 48
</pre></div>
</div>
<img alt="_images/nibetaseries_39_271.png" src="_images/nibetaseries_39_271.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 48 


30588
(264, 264)
i = 49
</pre></div>
</div>
<img alt="_images/nibetaseries_39_273.png" src="_images/nibetaseries_39_273.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 49 


40160
(264, 264)
i = 50
</pre></div>
</div>
<img alt="_images/nibetaseries_39_275.png" src="_images/nibetaseries_39_275.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 0 


40170
(264, 264)
i = 51
</pre></div>
</div>
<img alt="_images/nibetaseries_39_277.png" src="_images/nibetaseries_39_277.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 1 


40175
(264, 264)
i = 52
</pre></div>
</div>
<img alt="_images/nibetaseries_39_279.png" src="_images/nibetaseries_39_279.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 2 


40288
(264, 264)
i = 53
</pre></div>
</div>
<img alt="_images/nibetaseries_39_281.png" src="_images/nibetaseries_39_281.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 3 


40351
(264, 264)
i = 54
</pre></div>
</div>
<img alt="_images/nibetaseries_39_283.png" src="_images/nibetaseries_39_283.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 4 


40490
(264, 264)
i = 55
</pre></div>
</div>
<img alt="_images/nibetaseries_39_285.png" src="_images/nibetaseries_39_285.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 5 


40512
(264, 264)
i = 56
</pre></div>
</div>
<img alt="_images/nibetaseries_39_287.png" src="_images/nibetaseries_39_287.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 6 


40519
(264, 264)
i = 57
</pre></div>
</div>
<img alt="_images/nibetaseries_39_289.png" src="_images/nibetaseries_39_289.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 7 


40520
(264, 264)
i = 58
</pre></div>
</div>
<img alt="_images/nibetaseries_39_291.png" src="_images/nibetaseries_39_291.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 8 


40524
(264, 264)
i = 59
</pre></div>
</div>
<img alt="_images/nibetaseries_39_293.png" src="_images/nibetaseries_39_293.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 9 


40547
(264, 264)
i = 60
</pre></div>
</div>
<img alt="_images/nibetaseries_39_295.png" src="_images/nibetaseries_39_295.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 10 


40564
(264, 264)
i = 61
</pre></div>
</div>
<img alt="_images/nibetaseries_39_297.png" src="_images/nibetaseries_39_297.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 11 


40615
(264, 264)
i = 62
</pre></div>
</div>
<img alt="_images/nibetaseries_39_299.png" src="_images/nibetaseries_39_299.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 12 


40619
(264, 264)
i = 63
</pre></div>
</div>
<img alt="_images/nibetaseries_39_301.png" src="_images/nibetaseries_39_301.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 13 


40624
(264, 264)
i = 64
</pre></div>
</div>
<img alt="_images/nibetaseries_39_303.png" src="_images/nibetaseries_39_303.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 14 


40638
(264, 264)
i = 65
</pre></div>
</div>
<img alt="_images/nibetaseries_39_305.png" src="_images/nibetaseries_39_305.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 15 


40649
(264, 264)
i = 66
</pre></div>
</div>
<img alt="_images/nibetaseries_39_307.png" src="_images/nibetaseries_39_307.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 16 


40650
(264, 264)
i = 67
</pre></div>
</div>
<img alt="_images/nibetaseries_39_309.png" src="_images/nibetaseries_39_309.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 17 


40656
(264, 264)
i = 68
</pre></div>
</div>
<img alt="_images/nibetaseries_39_311.png" src="_images/nibetaseries_39_311.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 18 


40658
(264, 264)
i = 69
</pre></div>
</div>
<img alt="_images/nibetaseries_39_313.png" src="_images/nibetaseries_39_313.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 19 


40664
(264, 264)
i = 70
</pre></div>
</div>
<img alt="_images/nibetaseries_39_315.png" src="_images/nibetaseries_39_315.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 20 


40665
(264, 264)
i = 71
</pre></div>
</div>
<img alt="_images/nibetaseries_39_317.png" src="_images/nibetaseries_39_317.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 21 


40668
(264, 264)
i = 72
</pre></div>
</div>
<img alt="_images/nibetaseries_39_319.png" src="_images/nibetaseries_39_319.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 22 


40672
(264, 264)
i = 73
</pre></div>
</div>
<img alt="_images/nibetaseries_39_321.png" src="_images/nibetaseries_39_321.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 23 


40685
(264, 264)
i = 74
</pre></div>
</div>
<img alt="_images/nibetaseries_39_323.png" src="_images/nibetaseries_39_323.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 24 


40694
(264, 264)
i = 75
</pre></div>
</div>
<img alt="_images/nibetaseries_39_325.png" src="_images/nibetaseries_39_325.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 25 


40720
(264, 264)
i = 76
</pre></div>
</div>
<img alt="_images/nibetaseries_39_327.png" src="_images/nibetaseries_39_327.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 26 


40738
(264, 264)
i = 77
</pre></div>
</div>
<img alt="_images/nibetaseries_39_329.png" src="_images/nibetaseries_39_329.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 27 


40743
(264, 264)
i = 78
</pre></div>
</div>
<img alt="_images/nibetaseries_39_331.png" src="_images/nibetaseries_39_331.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 28 


40750
(264, 264)
i = 79
</pre></div>
</div>
<img alt="_images/nibetaseries_39_333.png" src="_images/nibetaseries_39_333.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 29 


40778
(264, 264)
i = 80
</pre></div>
</div>
<img alt="_images/nibetaseries_39_335.png" src="_images/nibetaseries_39_335.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 30 


40796
(264, 264)
i = 81
</pre></div>
</div>
<img alt="_images/nibetaseries_39_337.png" src="_images/nibetaseries_39_337.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 31 


40803
(264, 264)
i = 82
</pre></div>
</div>
<img alt="_images/nibetaseries_39_339.png" src="_images/nibetaseries_39_339.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 32 


40855
(264, 264)
i = 83
</pre></div>
</div>
<img alt="_images/nibetaseries_39_341.png" src="_images/nibetaseries_39_341.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 33 


40861
(264, 264)
i = 84
</pre></div>
</div>
<img alt="_images/nibetaseries_39_343.png" src="_images/nibetaseries_39_343.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 34 


40961
(264, 264)
i = 85
</pre></div>
</div>
<img alt="_images/nibetaseries_39_345.png" src="_images/nibetaseries_39_345.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 35 


40968
(264, 264)
i = 86
</pre></div>
</div>
<img alt="_images/nibetaseries_39_347.png" src="_images/nibetaseries_39_347.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 36 



mismatch
30004
(264, 264)
i = 0
</pre></div>
</div>
<img alt="_images/nibetaseries_39_349.png" src="_images/nibetaseries_39_349.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 0 


30008
(264, 264)
i = 1
</pre></div>
</div>
<img alt="_images/nibetaseries_39_351.png" src="_images/nibetaseries_39_351.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 1 


30009
(264, 264)
i = 2
</pre></div>
</div>
<img alt="_images/nibetaseries_39_353.png" src="_images/nibetaseries_39_353.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 2 


30015
(264, 264)
i = 3
</pre></div>
</div>
<img alt="_images/nibetaseries_39_355.png" src="_images/nibetaseries_39_355.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 3 


30019
(264, 264)
i = 4
</pre></div>
</div>
<img alt="_images/nibetaseries_39_357.png" src="_images/nibetaseries_39_357.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 4 


30020
(264, 264)
i = 5
</pre></div>
</div>
<img alt="_images/nibetaseries_39_359.png" src="_images/nibetaseries_39_359.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 5 


30023
(264, 264)
i = 6
</pre></div>
</div>
<img alt="_images/nibetaseries_39_361.png" src="_images/nibetaseries_39_361.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 6 


30040
(264, 264)
i = 7
</pre></div>
</div>
<img alt="_images/nibetaseries_39_363.png" src="_images/nibetaseries_39_363.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 7 


30057
(264, 264)
i = 8
</pre></div>
</div>
<img alt="_images/nibetaseries_39_365.png" src="_images/nibetaseries_39_365.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 8 


30064
(264, 264)
i = 9
</pre></div>
</div>
<img alt="_images/nibetaseries_39_367.png" src="_images/nibetaseries_39_367.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 9 


30066
(264, 264)
i = 10
</pre></div>
</div>
<img alt="_images/nibetaseries_39_369.png" src="_images/nibetaseries_39_369.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 10 


30069
(264, 264)
i = 11
</pre></div>
</div>
<img alt="_images/nibetaseries_39_371.png" src="_images/nibetaseries_39_371.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 11 


30074
(264, 264)
i = 12
</pre></div>
</div>
<img alt="_images/nibetaseries_39_373.png" src="_images/nibetaseries_39_373.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 12 


30085
(264, 264)
i = 13
</pre></div>
</div>
<img alt="_images/nibetaseries_39_375.png" src="_images/nibetaseries_39_375.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 13 


30088
(264, 264)
i = 14
</pre></div>
</div>
<img alt="_images/nibetaseries_39_377.png" src="_images/nibetaseries_39_377.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 14 


30090
(264, 264)
i = 15
</pre></div>
</div>
<img alt="_images/nibetaseries_39_379.png" src="_images/nibetaseries_39_379.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 15 


30091
(264, 264)
i = 16
</pre></div>
</div>
<img alt="_images/nibetaseries_39_381.png" src="_images/nibetaseries_39_381.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 16 


30095
(264, 264)
i = 17
</pre></div>
</div>
<img alt="_images/nibetaseries_39_383.png" src="_images/nibetaseries_39_383.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 17 


30096
(264, 264)
i = 18
</pre></div>
</div>
<img alt="_images/nibetaseries_39_385.png" src="_images/nibetaseries_39_385.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 18 


30105
(264, 264)
i = 19
</pre></div>
</div>
<img alt="_images/nibetaseries_39_387.png" src="_images/nibetaseries_39_387.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 19 


30116
(264, 264)
i = 20
</pre></div>
</div>
<img alt="_images/nibetaseries_39_389.png" src="_images/nibetaseries_39_389.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 20 


30118
(264, 264)
i = 21
</pre></div>
</div>
<img alt="_images/nibetaseries_39_391.png" src="_images/nibetaseries_39_391.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 21 


30119
(264, 264)
i = 22
</pre></div>
</div>
<img alt="_images/nibetaseries_39_393.png" src="_images/nibetaseries_39_393.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 22 


30128
(264, 264)
i = 23
</pre></div>
</div>
<img alt="_images/nibetaseries_39_395.png" src="_images/nibetaseries_39_395.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 23 


30181
(264, 264)
i = 24
</pre></div>
</div>
<img alt="_images/nibetaseries_39_397.png" src="_images/nibetaseries_39_397.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 24 


30217
(264, 264)
i = 25
</pre></div>
</div>
<img alt="_images/nibetaseries_39_399.png" src="_images/nibetaseries_39_399.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 25 


30227
(264, 264)
i = 26
</pre></div>
</div>
<img alt="_images/nibetaseries_39_401.png" src="_images/nibetaseries_39_401.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 26 


30236
(264, 264)
i = 27
</pre></div>
</div>
<img alt="_images/nibetaseries_39_403.png" src="_images/nibetaseries_39_403.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 27 


30242
(264, 264)
i = 28
</pre></div>
</div>
<img alt="_images/nibetaseries_39_405.png" src="_images/nibetaseries_39_405.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 28 


30255
(264, 264)
i = 29
</pre></div>
</div>
<img alt="_images/nibetaseries_39_407.png" src="_images/nibetaseries_39_407.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 29 


30274
(264, 264)
i = 30
</pre></div>
</div>
<img alt="_images/nibetaseries_39_409.png" src="_images/nibetaseries_39_409.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 30 


30283
(264, 264)
i = 31
</pre></div>
</div>
<img alt="_images/nibetaseries_39_411.png" src="_images/nibetaseries_39_411.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 31 


30295
(264, 264)
i = 32
</pre></div>
</div>
<img alt="_images/nibetaseries_39_413.png" src="_images/nibetaseries_39_413.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 32 


30330
(264, 264)
i = 33
</pre></div>
</div>
<img alt="_images/nibetaseries_39_415.png" src="_images/nibetaseries_39_415.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 33 


30346
(264, 264)
i = 34
</pre></div>
</div>
<img alt="_images/nibetaseries_39_417.png" src="_images/nibetaseries_39_417.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 34 


30376
(264, 264)
i = 35
</pre></div>
</div>
<img alt="_images/nibetaseries_39_419.png" src="_images/nibetaseries_39_419.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 35 


30395
(264, 264)
i = 36
</pre></div>
</div>
<img alt="_images/nibetaseries_39_421.png" src="_images/nibetaseries_39_421.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 36 


30400
(264, 264)
i = 37
</pre></div>
</div>
<img alt="_images/nibetaseries_39_423.png" src="_images/nibetaseries_39_423.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 37 


30403
(264, 264)
i = 38
</pre></div>
</div>
<img alt="_images/nibetaseries_39_425.png" src="_images/nibetaseries_39_425.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 38 


30412
(264, 264)
i = 39
</pre></div>
</div>
<img alt="_images/nibetaseries_39_427.png" src="_images/nibetaseries_39_427.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 39 


30426
(264, 264)
i = 40
</pre></div>
</div>
<img alt="_images/nibetaseries_39_429.png" src="_images/nibetaseries_39_429.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 40 


30432
(264, 264)
i = 41
</pre></div>
</div>
<img alt="_images/nibetaseries_39_431.png" src="_images/nibetaseries_39_431.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 41 


30466
(264, 264)
i = 42
</pre></div>
</div>
<img alt="_images/nibetaseries_39_433.png" src="_images/nibetaseries_39_433.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 42 


30469
(264, 264)
i = 43
</pre></div>
</div>
<img alt="_images/nibetaseries_39_435.png" src="_images/nibetaseries_39_435.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 43 


30476
30478
(264, 264)
i = 44
</pre></div>
</div>
<img alt="_images/nibetaseries_39_437.png" src="_images/nibetaseries_39_437.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 44 


30568
(264, 264)
i = 45
</pre></div>
</div>
<img alt="_images/nibetaseries_39_439.png" src="_images/nibetaseries_39_439.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 45 


30570
(264, 264)
i = 46
</pre></div>
</div>
<img alt="_images/nibetaseries_39_441.png" src="_images/nibetaseries_39_441.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 46 


30581
(264, 264)
i = 47
</pre></div>
</div>
<img alt="_images/nibetaseries_39_443.png" src="_images/nibetaseries_39_443.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 47 


30584
(264, 264)
i = 48
</pre></div>
</div>
<img alt="_images/nibetaseries_39_445.png" src="_images/nibetaseries_39_445.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 48 


30588
(264, 264)
i = 49
</pre></div>
</div>
<img alt="_images/nibetaseries_39_447.png" src="_images/nibetaseries_39_447.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>j = 49 


40160
(264, 264)
i = 50
</pre></div>
</div>
<img alt="_images/nibetaseries_39_449.png" src="_images/nibetaseries_39_449.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 0 


40170
(264, 264)
i = 51
</pre></div>
</div>
<img alt="_images/nibetaseries_39_451.png" src="_images/nibetaseries_39_451.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 1 


40175
(264, 264)
i = 52
</pre></div>
</div>
<img alt="_images/nibetaseries_39_453.png" src="_images/nibetaseries_39_453.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 2 


40288
(264, 264)
i = 53
</pre></div>
</div>
<img alt="_images/nibetaseries_39_455.png" src="_images/nibetaseries_39_455.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 3 


40351
(264, 264)
i = 54
</pre></div>
</div>
<img alt="_images/nibetaseries_39_457.png" src="_images/nibetaseries_39_457.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 4 


40490
(264, 264)
i = 55
</pre></div>
</div>
<img alt="_images/nibetaseries_39_459.png" src="_images/nibetaseries_39_459.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 5 


40512
(264, 264)
i = 56
</pre></div>
</div>
<img alt="_images/nibetaseries_39_461.png" src="_images/nibetaseries_39_461.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 6 


40519
(264, 264)
i = 57
</pre></div>
</div>
<img alt="_images/nibetaseries_39_463.png" src="_images/nibetaseries_39_463.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 7 


40520
(264, 264)
i = 58
</pre></div>
</div>
<img alt="_images/nibetaseries_39_465.png" src="_images/nibetaseries_39_465.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 8 


40524
(264, 264)
i = 59
</pre></div>
</div>
<img alt="_images/nibetaseries_39_467.png" src="_images/nibetaseries_39_467.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 9 


40547
(264, 264)
i = 60
</pre></div>
</div>
<img alt="_images/nibetaseries_39_469.png" src="_images/nibetaseries_39_469.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 10 


40564
(264, 264)
i = 61
</pre></div>
</div>
<img alt="_images/nibetaseries_39_471.png" src="_images/nibetaseries_39_471.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 11 


40615
(264, 264)
i = 62
</pre></div>
</div>
<img alt="_images/nibetaseries_39_473.png" src="_images/nibetaseries_39_473.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 12 


40619
(264, 264)
i = 63
</pre></div>
</div>
<img alt="_images/nibetaseries_39_475.png" src="_images/nibetaseries_39_475.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 13 


40624
(264, 264)
i = 64
</pre></div>
</div>
<img alt="_images/nibetaseries_39_477.png" src="_images/nibetaseries_39_477.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 14 


40638
(264, 264)
i = 65
</pre></div>
</div>
<img alt="_images/nibetaseries_39_479.png" src="_images/nibetaseries_39_479.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 15 


40649
(264, 264)
i = 66
</pre></div>
</div>
<img alt="_images/nibetaseries_39_481.png" src="_images/nibetaseries_39_481.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 16 


40650
(264, 264)
i = 67
</pre></div>
</div>
<img alt="_images/nibetaseries_39_483.png" src="_images/nibetaseries_39_483.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 17 


40656
(264, 264)
i = 68
</pre></div>
</div>
<img alt="_images/nibetaseries_39_485.png" src="_images/nibetaseries_39_485.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 18 


40658
(264, 264)
i = 69
</pre></div>
</div>
<img alt="_images/nibetaseries_39_487.png" src="_images/nibetaseries_39_487.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 19 


40664
(264, 264)
i = 70
</pre></div>
</div>
<img alt="_images/nibetaseries_39_489.png" src="_images/nibetaseries_39_489.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 20 


40665
(264, 264)
i = 71
</pre></div>
</div>
<img alt="_images/nibetaseries_39_491.png" src="_images/nibetaseries_39_491.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 21 


40668
(264, 264)
i = 72
</pre></div>
</div>
<img alt="_images/nibetaseries_39_493.png" src="_images/nibetaseries_39_493.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 22 


40672
(264, 264)
i = 73
</pre></div>
</div>
<img alt="_images/nibetaseries_39_495.png" src="_images/nibetaseries_39_495.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 23 


40685
(264, 264)
i = 74
</pre></div>
</div>
<img alt="_images/nibetaseries_39_497.png" src="_images/nibetaseries_39_497.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 24 


40694
(264, 264)
i = 75
</pre></div>
</div>
<img alt="_images/nibetaseries_39_499.png" src="_images/nibetaseries_39_499.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 25 


40720
(264, 264)
i = 76
</pre></div>
</div>
<img alt="_images/nibetaseries_39_501.png" src="_images/nibetaseries_39_501.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 26 


40738
(264, 264)
i = 77
</pre></div>
</div>
<img alt="_images/nibetaseries_39_503.png" src="_images/nibetaseries_39_503.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 27 


40743
(264, 264)
i = 78
</pre></div>
</div>
<img alt="_images/nibetaseries_39_505.png" src="_images/nibetaseries_39_505.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 28 


40750
(264, 264)
i = 79
</pre></div>
</div>
<img alt="_images/nibetaseries_39_507.png" src="_images/nibetaseries_39_507.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 29 


40778
(264, 264)
i = 80
</pre></div>
</div>
<img alt="_images/nibetaseries_39_509.png" src="_images/nibetaseries_39_509.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 30 


40796
(264, 264)
i = 81
</pre></div>
</div>
<img alt="_images/nibetaseries_39_511.png" src="_images/nibetaseries_39_511.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 31 


40803
(264, 264)
i = 82
</pre></div>
</div>
<img alt="_images/nibetaseries_39_513.png" src="_images/nibetaseries_39_513.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 32 


40855
(264, 264)
i = 83
</pre></div>
</div>
<img alt="_images/nibetaseries_39_515.png" src="_images/nibetaseries_39_515.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 33 


40861
(264, 264)
i = 84
</pre></div>
</div>
<img alt="_images/nibetaseries_39_517.png" src="_images/nibetaseries_39_517.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 34 


40961
(264, 264)
i = 85
</pre></div>
</div>
<img alt="_images/nibetaseries_39_519.png" src="_images/nibetaseries_39_519.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 35 


40968
(264, 264)
i = 86
</pre></div>
</div>
<img alt="_images/nibetaseries_39_521.png" src="_images/nibetaseries_39_521.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k = 36 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue&#39;</span><span class="p">][</span><span class="n">dmn</span><span class="p">][:,</span><span class="n">dmn</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">c</span><span class="o">/</span><span class="n">c825cr816cg14jn4bs40my5h0000gr</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_15249</span><span class="o">/</span><span class="mf">955757746.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue&#39;</span><span class="p">][</span><span class="n">dmn</span><span class="p">][:,</span><span class="n">dmn</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

<span class="ne">TypeError</span>: &#39;float&#39; object is not subscriptable
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue_ya&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(264, 264, 51)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue_oa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(264, 264, 37)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">savemat</span><span class="p">(</span><span class="s1">&#39;/Volumes/schnyer/Megan/adm_mem-fc/analysis/nbs/dsnmat_ya_oa.mat&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dsn_ya_oa&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">51</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">37</span><span class="p">,</span><span class="mi">1</span><span class="p">)))),</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">51</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">37</span><span class="p">,</span><span class="mi">1</span><span class="p">))))))})</span>
</pre></div>
</div>
</div>
</div>
<p>Remove 30476</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">savemat</span><span class="p">(</span><span class="s1">&#39;/Volumes/schnyer/Megan/adm_mem-fc/analysis/nbs/memmatch_fc_dmn-fpn.mat&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fc_dmnfpn&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue&#39;</span><span class="p">][</span><span class="n">dmn_fpn</span><span class="p">][:,</span><span class="n">dmn_fpn</span><span class="p">]})</span>
<span class="n">savemat</span><span class="p">(</span><span class="s1">&#39;/Volumes/schnyer/Megan/adm_mem-fc/analysis/nbs/memmatch_fc_dmn.mat&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fc_dmn&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue&#39;</span><span class="p">][</span><span class="n">dmn</span><span class="p">][:,</span><span class="n">dmn</span><span class="p">]})</span>
<span class="n">savemat</span><span class="p">(</span><span class="s1">&#39;/Volumes/schnyer/Megan/adm_mem-fc/analysis/nbs/memmatch_fc_fpn.mat&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fc_fpn&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue&#39;</span><span class="p">][</span><span class="n">fpn</span><span class="p">][:,</span><span class="n">fpn</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;/Volumes/schnyer/Megan/adm_mem-fc/analysis/nbs/coords_fpn.txt&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="p">[</span><span class="n">fpn</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;/Volumes/schnyer/Megan/adm_mem-fc/analysis/nbs/coords_dmn.txt&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="p">[</span><span class="n">dmn</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;/Volumes/schnyer/Megan/adm_mem-fc/analysis/nbs/coords_dmn_fpn.txt&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="p">[</span><span class="n">dmn_fpn</span><span class="p">],</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue&#39;</span><span class="p">][</span><span class="n">dmn_fpn</span><span class="p">][:,</span><span class="n">dmn_fpn</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1268a2250&gt;
</pre></div>
</div>
<img alt="_images/nibetaseries_48_1.png" src="_images/nibetaseries_48_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue_ya&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x12559dd10&gt;
</pre></div>
</div>
<img alt="_images/nibetaseries_49_1.png" src="_images/nibetaseries_49_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue_oa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x125a1db90&gt;
</pre></div>
</div>
<img alt="_images/nibetaseries_50_1.png" src="_images/nibetaseries_50_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atlas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">fpn</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;, &#39;Fronto-parietal Task Control&#39;,
       &#39;Fronto-parietal Task Control&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">coords</span><span class="p">[</span><span class="n">dmn_fpn</span><span class="p">],</span> <span class="n">atlas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dmn_fpn</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[6, 67, -4, &#39;Default mode&#39;],
 [8, 48, -15, &#39;Default mode&#39;],
 [-13, -40, 1, &#39;Default mode&#39;],
 [-18, 63, -9, &#39;Default mode&#39;],
 [-46, -61, 21, &#39;Default mode&#39;],
 [43, -72, 28, &#39;Default mode&#39;],
 [-44, 12, -34, &#39;Default mode&#39;],
 [46, 16, -30, &#39;Default mode&#39;],
 [-68, -23, -16, &#39;Default mode&#39;],
 [-58, -26, -15, &#39;Default mode&#39;],
 [-39, -75, 44, &#39;Default mode&#39;],
 [-7, -55, 27, &#39;Default mode&#39;],
 [6, -59, 35, &#39;Default mode&#39;],
 [-11, -56, 16, &#39;Default mode&#39;],
 [-3, -49, 13, &#39;Default mode&#39;],
 [8, -48, 31, &#39;Default mode&#39;],
 [15, -63, 26, &#39;Default mode&#39;],
 [-2, -37, 44, &#39;Default mode&#39;],
 [11, -54, 17, &#39;Default mode&#39;],
 [52, -59, 36, &#39;Default mode&#39;],
 [23, 33, 48, &#39;Default mode&#39;],
 [-10, 39, 52, &#39;Default mode&#39;],
 [-16, 29, 53, &#39;Default mode&#39;],
 [-35, 20, 51, &#39;Default mode&#39;],
 [22, 39, 39, &#39;Default mode&#39;],
 [13, 55, 38, &#39;Default mode&#39;],
 [-10, 55, 39, &#39;Default mode&#39;],
 [-20, 45, 39, &#39;Default mode&#39;],
 [6, 54, 16, &#39;Default mode&#39;],
 [6, 64, 22, &#39;Default mode&#39;],
 [-7, 51, -1, &#39;Default mode&#39;],
 [9, 54, 3, &#39;Default mode&#39;],
 [-3, 44, -9, &#39;Default mode&#39;],
 [8, 42, -5, &#39;Default mode&#39;],
 [-11, 45, 8, &#39;Default mode&#39;],
 [-2, 38, 36, &#39;Default mode&#39;],
 [-3, 42, 16, &#39;Default mode&#39;],
 [-20, 64, 19, &#39;Default mode&#39;],
 [-8, 48, 23, &#39;Default mode&#39;],
 [65, -12, -19, &#39;Default mode&#39;],
 [-56, -13, -10, &#39;Default mode&#39;],
 [-58, -30, -4, &#39;Default mode&#39;],
 [65, -31, -9, &#39;Default mode&#39;],
 [-68, -41, -5, &#39;Default mode&#39;],
 [13, 30, 59, &#39;Default mode&#39;],
 [12, 36, 20, &#39;Default mode&#39;],
 [52, -2, -16, &#39;Default mode&#39;],
 [-26, -40, -8, &#39;Default mode&#39;],
 [27, -37, -13, &#39;Default mode&#39;],
 [-34, -38, -16, &#39;Default mode&#39;],
 [28, -77, -32, &#39;Default mode&#39;],
 [52, 7, -30, &#39;Default mode&#39;],
 [-53, 3, -27, &#39;Default mode&#39;],
 [47, -50, 29, &#39;Default mode&#39;],
 [-49, -42, 1, &#39;Default mode&#39;],
 [-31, 19, -19, &#39;Default mode&#39;],
 [-10, 11, 67, &#39;Default mode&#39;],
 [8, -91, -7, &#39;Default mode&#39;],
 [48, 25, 27, &#39;Fronto-parietal Task Control&#39;],
 [-47, 11, 23, &#39;Fronto-parietal Task Control&#39;],
 [-53, -49, 43, &#39;Fronto-parietal Task Control&#39;],
 [-23, 11, 64, &#39;Fronto-parietal Task Control&#39;],
 [58, -53, -14, &#39;Fronto-parietal Task Control&#39;],
 [24, 45, -15, &#39;Fronto-parietal Task Control&#39;],
 [34, 54, -13, &#39;Fronto-parietal Task Control&#39;],
 [-21, 41, -20, &#39;Fronto-parietal Task Control&#39;],
 [-41, 6, 33, &#39;Fronto-parietal Task Control&#39;],
 [-42, 38, 21, &#39;Fronto-parietal Task Control&#39;],
 [38, 43, 15, &#39;Fronto-parietal Task Control&#39;],
 [49, -42, 45, &#39;Fronto-parietal Task Control&#39;],
 [-28, -58, 48, &#39;Fronto-parietal Task Control&#39;],
 [44, -53, 47, &#39;Fronto-parietal Task Control&#39;],
 [32, 14, 56, &#39;Fronto-parietal Task Control&#39;],
 [37, -65, 40, &#39;Fronto-parietal Task Control&#39;],
 [-42, -55, 45, &#39;Fronto-parietal Task Control&#39;],
 [40, 18, 40, &#39;Fronto-parietal Task Control&#39;],
 [-34, 55, 4, &#39;Fronto-parietal Task Control&#39;],
 [-42, 45, -2, &#39;Fronto-parietal Task Control&#39;],
 [33, -53, 44, &#39;Fronto-parietal Task Control&#39;],
 [43, 49, -2, &#39;Fronto-parietal Task Control&#39;],
 [-42, 25, 30, &#39;Fronto-parietal Task Control&#39;],
 [-3, 26, 44, &#39;Fronto-parietal Task Control&#39;],
 [11, -39, 50, &#39;Fronto-parietal Task Control&#39;]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="age-group-differences-in-dmn-fpn-fc-during-cue-a-id-age-group-dif-mean-fc-a">
<h2>Age group differences in DMN-FPN FC during cue <a id='age-group-dif-mean-fc'></a><a class="headerlink" href="#age-group-differences-in-dmn-fpn-fc-during-cue-a-id-age-group-dif-mean-fc-a" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/memmatch_fc.npy&#39;</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">fc_subs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;/Volumes/psybrain/ADM/derivatives/nibs/fcsubs.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpy</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue_ya&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">n_lines</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">xpy</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">node_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">coords</span><span class="p">[</span><span class="n">dmn_fpn</span><span class="p">],</span> <span class="n">atlas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dmn_fpn</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>             
<span class="n">plot_connectivity_circle</span><span class="p">(</span><span class="n">xpy</span><span class="p">[</span><span class="n">dmn_fpn</span><span class="p">][:,</span><span class="n">dmn_fpn</span><span class="p">],</span> <span class="n">node_labels</span><span class="p">,</span> <span class="n">n_lines</span><span class="o">=</span><span class="n">n_lines</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Retrieval: Young Adults&#39;</span><span class="p">,</span> 
                         <span class="n">fontsize_title</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">textcolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                         <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">node_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> 
                         <span class="n">node_edgecolor</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">results_dir</span> <span class="o">+</span> <span class="s1">&#39;cue_ya_mean_dmn-fpn_fc.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/site-packages/ipykernel_launcher.py:3: RuntimeWarning: invalid value encountered in greater
  This is separate from the ipykernel package so we can avoid doing imports until
</pre></div>
</div>
<img alt="_images/nibetaseries_55_1.png" src="_images/nibetaseries_55_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpo</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue_oa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="n">node_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">coords</span><span class="p">[</span><span class="n">dmn_fpn</span><span class="p">],</span> <span class="n">atlas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dmn_fpn</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">plot_connectivity_circle</span><span class="p">(</span><span class="n">xpo</span><span class="p">[</span><span class="n">dmn_fpn</span><span class="p">][:,</span><span class="n">dmn_fpn</span><span class="p">],</span> <span class="n">node_labels</span><span class="p">,</span> <span class="n">n_lines</span><span class="o">=</span><span class="n">n_lines</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Retrieval: Older Adults&#39;</span><span class="p">,</span> 
                         <span class="n">fontsize_title</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">textcolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                         <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">node_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> 
                         <span class="n">node_edgecolor</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">results_dir</span> <span class="o">+</span> <span class="s1">&#39;cue_oa_mean_dmn-fpn_fc.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/nibetaseries_56_0.png" src="_images/nibetaseries_56_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue_ya&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(264, 264, 51)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue_oa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(264, 264, 37)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue_oa&#39;</span><span class="p">][:,:,</span><span class="mi">35</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.        , 0.63977629, 0.01653341, ..., 0.34015785, 0.03554068,
        0.21508494],
       [0.63977629, 0.        , 0.30250593, ..., 0.67654755, 0.31423401,
        0.39361927],
       [0.01653341, 0.30250593, 0.        , ..., 0.35144185, 0.09509778,
        0.32740648],
       ...,
       [0.34015785, 0.67654755, 0.35144185, ..., 0.        , 0.53777688,
        0.36343411],
       [0.03554068, 0.31423401, 0.09509778, ..., 0.53777688, 0.        ,
        0.19420943],
       [0.21508494, 0.39361927, 0.32740648, ..., 0.36343411, 0.19420943,
        0.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;cue_ya&#39;</span><span class="p">][</span><span class="n">fpn</span><span class="p">][:,</span><span class="n">fpn</span><span class="p">,:]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(25, 25, 51)
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By The Jupyter Book Community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>